<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.122.0">


<title>Delayed effect asymptotic approximations and simulation - Spending time examples  - Keaven M. Anderson</title>



  <link href='https://keaven.github.io/favicon.ico' rel='icon' type='image/x-icon'/>



  
  <meta property="description" content="Asymptotic approximations and simulations for group sequential designs with delayed treatment effects, using gsDesign2 and simtrial.
">
  




<meta property="og:title" content="Delayed effect asymptotic approximations and simulation">
<meta property="og:description" content="Asymptotic approximations and simulations for group sequential designs with delayed treatment effects, using gsDesign2 and simtrial.
">
<meta property="og:url" content="https://keaven.github.io/blog/delayed-effect-simulation/">



  
  
    
  

<meta property="og:image" content="https://keaven.github.io/blog/delayed-effect-simulation/images/erik-mclean-7lyRKyKIdJY-unsplash.jpg">

<meta property="og:type" content="article">







<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">
<link rel="stylesheet" href="/css/textmate.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/logo.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="/blog/">Blog</a></li>
    
    <li><a href="/publications/">Publications</a></li>
    
    <li><a href="/software/">Software</a></li>
    
    <li><a href="/books/">Books</a></li>
    
    <li><a href="/talks/">Talks</a></li>
    
  </ul>

  <ul class="nav-social-links">
    
      
      <li><a href="https://github.com/keaven" target="_blank"><img src="/images/github.svg" alt="GitHub"></a></li>
      
      
      <li><a href="https://linkedin.com/in/keaven-anderson-09aa7538" target="_blank"><img src="/images/linkedin.svg" alt="LinkedIn"></a></li>
      
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">41 min read</span>
    

    <h1 class="article-title">Delayed effect asymptotic approximations and simulation</h1>

    
    <h2 class="article-subtitle">Spending time examples</h2>
    

    
    
    
    <span class="article-author">Keaven Anderson</span>
    
    

    
    <p class="tags">
      Tags:&nbsp;<a href="/tags/gsdesign2/">gsDesign2</a>, <a href="/tags/simtrial/">simtrial</a>, <a href="/tags/group-sequential-design/">group sequential design</a>, <a href="/tags/delayed-treatment-effect/">delayed treatment effect</a>, <a href="/tags/non-proportional-hazards/">non-proportional hazards</a>, <a href="/tags/time-to-event/">time-to-event</a></p>
    

    <span class="article-date">Published Date: June 19, 2025</span>
    

    <div class="article-content">
      
      
<link href="https://keaven.github.io/blog/delayed-effect-simulation/index_files/htmltools-fill/fill.css" rel="stylesheet" />
<script src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/htmlwidgets/htmlwidgets.js"></script>
<link href="https://keaven.github.io/blog/delayed-effect-simulation/index_files/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/datatables-binding/datatables.js"></script>
<script src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/jquery/jquery-3.6.0.min.js"></script>
<link href="https://keaven.github.io/blog/delayed-effect-simulation/index_files/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="https://keaven.github.io/blog/delayed-effect-simulation/index_files/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/dt-core/js/jquery.dataTables.min.js"></script>
<link href="https://keaven.github.io/blog/delayed-effect-simulation/index_files/nouislider/jquery.nouislider.min.css" rel="stylesheet" />
<script src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/nouislider/jquery.nouislider.min.js"></script>
<link href="https://keaven.github.io/blog/delayed-effect-simulation/index_files/selectize/selectize.bootstrap3.css" rel="stylesheet" />
<script src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/selectize/selectize.min.js"></script>
<link href="https://keaven.github.io/blog/delayed-effect-simulation/index_files/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
<script src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/crosstalk/js/crosstalk.min.js"></script>

<div id="TOC">
<ul>
<li><a href="#overview" id="toc-overview">Overview</a></li>
<li><a href="#computing-preliminaries" id="toc-computing-preliminaries">Computing preliminaries</a></li>
<li><a href="#design-assumptions" id="toc-design-assumptions">Design assumptions</a></li>
<li><a href="#fixed-design" id="toc-fixed-design">Fixed design</a>
<ul>
<li><a href="#simulation-of-fixed-design" id="toc-simulation-of-fixed-design">Simulation of fixed design</a></li>
</ul></li>
<li><a href="#group-sequential-design" id="toc-group-sequential-design">Group sequential design</a>
<ul>
<li><a href="#same-design-with-weighted-logrank" id="toc-same-design-with-weighted-logrank">Same design with weighted logrank</a></li>
</ul></li>
<li><a href="#accumulation-of-events-and-average-treatment-effect-over-time" id="toc-accumulation-of-events-and-average-treatment-effect-over-time">Accumulation of events and average treatment effect over time</a></li>
<li><a href="#alternate-analysis-timing-and-alpha-spending-strategies" id="toc-alternate-analysis-timing-and-alpha-spending-strategies">Alternate analysis timing and <span class="math inline">\(\alpha\)</span>-spending strategies</a></li>
<li><a href="#simulation-to-verify-operating-characteristics" id="toc-simulation-to-verify-operating-characteristics">Simulation to verify operating characteristics</a>
<ul>
<li><a href="#simulate-a-single-trial-and-perform-tests" id="toc-simulate-a-single-trial-and-perform-tests">Simulate a single trial and perform tests</a></li>
<li><a href="#simulate-multiple-trials-in-parallel" id="toc-simulate-multiple-trials-in-parallel">Simulate multiple trials in parallel</a></li>
</ul></li>
<li><a href="#summary" id="toc-summary">Summary</a></li>
<li><a href="#session-info" id="toc-session-info">Session info</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p>
</p>
<div class="float">
<img src="images/erik-mclean-7lyRKyKIdJY-unsplash.jpg" alt="Expect delays. Photo by Erik Mclean." />
<div class="figcaption">Expect delays. Photo by <a href="https://unsplash.com/photos/7lyRKyKIdJY">Erik Mclean</a>.</div>
</div>
<div class="callout">
<p><strong>Update (2025-07-10):</strong> Minor edits to compute cumulative power by analysis
and correct table numbering. Render with gsDesign2 1.1.5 and simtrial 1.0.0.</p>
<p><strong>Update (2025-06-27):</strong> The way to specify weights for WLR designs
has changed to match the new syntax in gsDesign2 1.1.4,
which is now used to render this post.</p>
</div>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>We consider asymptotic approximations and corresponding simulations for
group sequential designs with delayed treatment effects.
We demonstrate:</p>
<ul>
<li>the importance of both adequate events and adequate follow-up duration to
ensure power in a fixed design, and</li>
<li>the importance of guaranteeing a reasonable amount of <span class="math inline">\(\alpha\)</span>-spending for
the final analysis in a group sequential design.</li>
</ul>
<p>We demonstrate the concept of spending time as an effective way to adapt.
Traditionally <span class="citation">Lan and DeMets (<a href="#ref-LanDeMets">1983</a>)</span>, spending has been done according to targeting a
specific number of events for an outcome at the end of the trial.
However, for delayed treatment effect scenarios there is substantial literature
<span class="citation">(e.g., <a href="#ref-NPHWG2020sim">Lin et al. 2020</a>; <a href="#ref-NPHWG2021Design">Roychoudhury et al. 2021</a>)</span> documenting the
importance of adequate follow-up duration in addition to requiring an adequate
number of events under the traditional proportional hazards assumption.</p>
<p>While other approaches could be taken, we have found the spending time approach
generalizes well for addressing a variety of scenarios.
The fact that spending does not need to correspond to information fraction
was perhaps first raised by <span class="citation">Lan and DeMets (<a href="#ref-LanDeMets1989">1989</a>)</span> where calendar-time spending was discussed.
However, we note that <span class="citation">Michael A. Proschan, Lan, and Wittes (<a href="#ref-PLWBook">2006</a>)</span> have raised other scenarios where spending
alternatives are considered.
These approaches are generally more complicated to implement than the
spending time approach suggested here.
Two specific spending alternative approaches are examined here:</p>
<ul>
<li>Spending according to the minimum of planned and observed event counts.
This is suggested for the delayed effect examples.</li>
<li>Spending fixed amounts at analyses as suggested by <span class="citation">Fleming, Harrington, and O’Brien (<a href="#ref-FHO">1984</a>)</span>.</li>
</ul>
<p>Regardless of the spending approach, it is important that timing of analyses
be pre-defined in a way that is independent of observed treatment effect.
This independence assumption is required to use the usual asymptotic normal
calculations for computing group sequential boundary crossing probabilities.
As noted by <span class="citation">Michael A. Proschan, Follmann, and Waclawiw (<a href="#ref-PFW">1992</a>)</span>, issues arising due to nefarious strategies when treatment
differences are known at interim analysis can be largely limited
by appropriate approaches
we revisit these for the <span class="math inline">\(\alpha\)</span>-spending approach that we extend here and
the fixed interim <span class="math inline">\(\alpha\)</span>-spending method of <span class="citation">Fleming, Harrington, and O’Brien (<a href="#ref-FHO">1984</a>)</span>.
Asymptotic distribution theory is always determined by statistical information
at analyses that information is proportional to event counts for the logrank test.
However, spending only needs to increase with event counts and there is no
requirement that spending be a direct function of event count.
While spending will always be an implicit or indirect function of event count,
the function can be much easier to express by using the concept of spending time
as in the cases noted above.</p>
</div>
<div id="computing-preliminaries" class="section level2">
<h2>Computing preliminaries</h2>
<p>Attach packages.</p>
<pre class="r"><code>library(gsDesign)
library(gsDesign2)
library(tibble)
library(dplyr)
library(gt)
library(ggplot2)
library(parallelly)
library(doFuture)
library(purrr)
library(DT)
library(simtrial)
library(tictoc)
library(cowplot)</code></pre>
<pre class="r"><code># Set to TRUE if large simulations are to be run and saved.
# Set to FALSE if simulations have already been run and saved and you want to load them.
run_simulations &lt;- TRUE</code></pre>
<p>Set up parallel computing.</p>
<pre class="r"><code>cores_used &lt;- 32
message(&quot;Parallelizing across &quot;, cores_used, &quot; CPUs&quot;)

# Set up the future plan to use the specified number of parallel workers
plan(&quot;multisession&quot;, workers = cores_used)</code></pre>
<p>Set seed and number of simulations.</p>
<pre class="r"><code># Set a seed for reproducibility and use `.options.future = list(seed = TRUE)`
# for parallel-safe RNG. Use foreach + %dofuture% to perform parallel computation.
set.seed(42)
nsim &lt;- 100000</code></pre>
</div>
<div id="design-assumptions" class="section level2">
<h2>Design assumptions</h2>
<p>We begin with assumptions for the group sequential design as well as for
alternate scenarios.
The approach taken for the asymptotic normal approximation for the logrank test
uses an average hazard ratio approach for approximating treatment effect <span class="citation">Mukhopadhyay et al. (<a href="#ref-AHR2020">2020</a>)</span>.
When group sequential analyses are performed, we justify the joint distribution
of logrank tests by the theory of <span class="citation">Tsiatis (<a href="#ref-Tsiatis1982">1982</a>)</span>.
Simulations are easily run for each scenario to verify asymptotic approximations
of operating characteristics.</p>
<pre class="r"><code># Only one enrollment assumption used
# This could be important to vary
enrollRates &lt;- define_enroll_rate(duration = 12, rate = 1)
# Planned study duration
analysisTimes &lt;- 36
# Constant dropout rate across all scenarios
dropoutRate &lt;- 0.001
# 1-sided Type I error
alpha &lt;- 0.025
# Targeted Type II error (1 - power) for original plan (scenario 1)
beta &lt;- 0.1
scenarios &lt;- tribble(
  ~i, ~ControlMedian, ~Delay, ~hr1, ~hr2,              ~Scenario,
   1,             12,      4,    1,  0.6,        &quot;Original plan&quot;,
   2,             10,      6,  1.2,  0.5, &quot;Events accrue faster&quot;,
   3,             16,      6,    1, 0.55, &quot;Events accrue slower&quot;,
   4,             12,      4,  0.7,  0.7, &quot;Proportional hazards&quot;,
   5,             12,      4,    1,    1,      &quot;Null hypothesis&quot;
)</code></pre>
<p>We consider 5 failure rate scenarios for group sequential design.
Control observations are always exponential with a scenario-specific failure rate.
Experimental observations are piecewise exponential with a hazard ratio <code>hr1</code>
for duration <code>Delay</code> (Delay) and hazard ratio <code>hr2</code> thereafter.</p>
<pre class="r"><code>scenarios |&gt;
  transmute(
    Scenario = factor(Scenario),
    &quot;Control Median&quot; = factor(ControlMedian),
    Delay = factor(Delay),
    hr1 = factor(hr1),
    hr2 = factor(hr2)
  ) |&gt;
  datatable(
    options = list(
      pageLength = 5,
      autoWidth = TRUE,
      columnDefs = list(list(className = &quot;dt-center&quot;, targets = &quot;_all&quot;))
    ),
    filter = &quot;top&quot;,
    caption = &quot;Table 1: Failure rate scenarios studied&quot;
  )</code></pre>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Events accrue faster&quot;,&quot;Events accrue slower&quot;,&quot;Null hypothesis&quot;,&quot;Original plan&quot;,&quot;Proportional hazards&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;10&quot;,&quot;12&quot;,&quot;16&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;4&quot;,&quot;6&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0.7&quot;,&quot;1&quot;,&quot;1.2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0.5&quot;,&quot;0.55&quot;,&quot;0.6&quot;,&quot;0.7&quot;,&quot;1&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>Table 1: Failure rate scenarios studied<\/caption>","data":[["1","2","3","4","5"],["Original plan","Events accrue faster","Events accrue slower","Proportional hazards","Null hypothesis"],["12","10","16","12","12"],["4","6","6","4","4"],["1","1.2","1","0.7","1"],["0.6","0.5","0.55","0.7","1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Scenario<\/th>\n      <th>Control Median<\/th>\n      <th>Delay<\/th>\n      <th>hr1<\/th>\n      <th>hr2<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"autoWidth":true,"columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Scenario","targets":1},{"name":"Control Median","targets":2},{"name":"Delay","targets":3},{"name":"hr1","targets":4},{"name":"hr2","targets":5}],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="fixed-design" class="section level2">
<h2>Fixed design</h2>
<pre class="r"><code># Fixed design, single stratum
# Find sample size for 36 month trial under given
# enrollment and sample size assumptions
failRates &lt;- define_fail_rate(
  duration = c(scenarios$Delay[1], 100),
  fail_rate = log(2) / scenarios$ControlMedian[1],
  hr = c(scenarios$hr1[1], scenarios$hr2[1]),
  dropout_rate = dropoutRate
)

xx &lt;- gs_design_ahr(
  enroll_rate = enrollRates,
  fail_rate = failRates,
  alpha = alpha,
  beta = beta,
  info_frac = NULL,
  analysis_time = analysisTimes,
  ratio = 1,
  binding = FALSE,
  upper = gs_b,
  upar = qnorm(0.975),
  lower = gs_b,
  lpar = qnorm(0.975),
  h1_spending = TRUE,
  test_upper = TRUE,
  test_lower = TRUE,
) |&gt; to_integer()

Events &lt;- xx$analysis$event
N &lt;- xx$analysis$n
enrollRates$rate &lt;- N / enrollRates$duration</code></pre>
<pre class="r"><code>upar &lt;- qnorm(0.975)
lpar &lt;- upar
output &lt;- NULL
for (i in 1:nrow(scenarios)) {
  # Set failure rates
  # Failure rates from 1st scenario for design
  failRates &lt;- define_fail_rate(
    duration = c(scenarios$Delay[i], 100),
    fail_rate = log(2) / scenarios$ControlMedian[i],
    hr = c(scenarios$hr1[i], scenarios$hr2[i]),
    dropout_rate = dropoutRate
  )
  # Require events only
  yEvents &lt;- gs_power_ahr(
    enroll_rate = enrollRates,
    fail_rate = failRates,
    event = Events,
    analysis_time = NULL,
    upar = upar,
    upper = gs_b,
    lpar = lpar,
    lower = gs_b
  )
  # Require time only
  yTime &lt;- gs_power_ahr(
    enroll_rate = enrollRates,
    fail_rate = failRates,
    event = NULL,
    analysis_time = analysisTimes,
    upar = upar,
    upper = gs_b,
    lpar = lpar,
    lower = gs_b
  )
  # Require events and time for analysis timing
  yBoth &lt;- gs_power_ahr(
    enroll_rate = enrollRates,
    fail_rate = failRates,
    event = Events,
    analysis_time = analysisTimes,
    upar = upar,
    upper = gs_b,
    lpar = lpar,
    lower = gs_b
  )
  output &lt;- rbind(
    output,
    tibble(
      i = i,
      Scenario = scenarios$Scenario[i],
      &quot;Control Median&quot; = scenarios$ControlMedian[i],
      Delay = scenarios$Delay[i],
      HR1 = scenarios$hr1[i],
      HR2 = scenarios$hr2[i],
      Timing = &quot;Event-based&quot;,
      N = N,
      Events = yEvents$analysis$event,
      Time = yEvents$analysis$time,
      AHR = yEvents$analysis$ahr,
      Power = yEvents$bound$probability[1],
      `HR at bound` = yEvents$bound$`~hr at bound`[1]
    ),
    tibble(
      i = i,
      Scenario = scenarios$Scenario[i],
      &quot;Control Median&quot; = scenarios$ControlMedian[i],
      Delay = scenarios$Delay[i],
      HR1 = scenarios$hr1[i],
      HR2 = scenarios$hr2[i],
      Timing = &quot;Time-based&quot;,
      N = N,
      Events = yTime$analysis$event,
      Time = yTime$analysis$time,
      AHR = yTime$analysis$ahr,
      Power = yTime$bound$probability[1],
      `HR at bound` = yTime$bound$`~hr at bound`[1]
    ),
    tibble(
      i = i,
      Scenario = scenarios$Scenario[i],
      &quot;Control Median&quot; = scenarios$ControlMedian[i],
      Delay = scenarios$Delay[i],
      HR1 = scenarios$hr1[i],
      HR2 = scenarios$hr2[i],
      Timing = &quot;Max of time- and event-cutoff&quot;,
      N = N,
      Events = yBoth$analysis$event,
      Time = yBoth$analysis$time,
      AHR = yBoth$analysis$ahr,
      Power = yBoth$bound$probability[1],
      `HR at bound` = yBoth$bound$`~hr at bound`[1]
    )
  )
}</code></pre>
<p>A sample size of 422 and 312 targeted events was derived
based on Scenario 1 assumptions using the method of <span class="citation">Zhao, Zhang, and Anderson (<a href="#ref-zhao2024group">2024</a>)</span>.
This method computes an average hazard ratio at the time of analysis that approximates
what is produced by a Cox regression model
we will verify this below using simulated trials.
The design has the following additional characteristics:</p>
<ul>
<li>An exponential dropout rate of 0.001 in both treatment groups.</li>
<li>A constant random enrollment rate is planned for 12 months piecewise constant
enrollment is also an option in the software.</li>
<li>Sample size rounded up to an even number.</li>
<li>Targeted events rounded up to an integer.</li>
<li>Planned analysis time at 36 months.</li>
<li>Spending is based on the information fraction at the planned analysis times
using a Lan-DeMets spending function to approximate the O’Brien-Fleming spending function.</li>
<li>One-sided testing only; no futility bound.</li>
<li>Sample size rounded to an even number, event counts rounded to the nearest
integer for interim analyses and rounded up for the final analysis.</li>
</ul>
<p>Table 2 summarizes operating characteristics for the 3 scenarios with each of
the analysis timing methods.
For event-based timing, the second scenario is more poorly powered than for
calendar-based timing.
For calendar-based timing, the third scenario is more poorly powered than for
event-based timing.
Thus, requiring both calendar duration and the targeted number of events
before performing analysis ensures good power for all 3 scenarios;
neither calendar- nor event-based timing achieve this goal.
We note a few things about the alternate strategies:</p>
<ul>
<li>The approximate hazard ratio required for statistical significance is close to
0.8 for all scenarios. Thus, if this is used as one measure of clinical
significance, we have not gamed the timing of the final analysis to reach
significance with a substantially lesser treatment effect.</li>
<li>For the scenario with more events accruing early and a longer effect delay,
the increased events (380 vs 342) and bigger underlying treatment effect
(AHR of 0.78 vs 0.76) achieved by delaying the analysis time resulted in
a meaningful power increase (64% to 77%),</li>
<li>For the scenario with slower event accrual, delaying the analysis until the
targeted events accrue compared to analyzing at the targeted time resulted
in a larger number of expected events (342 vs. 295), more substantial
average hazard reduction (0.715 vs 0.735) and greater power (87% vs 75%).</li>
</ul>
<p>Since trials represent a very large investment of patients, provider efforts
(care and follow-up), and money, the gains from setting timing based on the
maximum of event- and calendar-targets has important benefits.
While this strategy can result in a delay in study completion, we can still
do group sequential analysis to stop early for a larger than a conservatively
planned treatment effect used for design.</p>
<pre class="r"><code>output |&gt;
  select(-i) |&gt;
  group_by(Timing) |&gt;
  gt() |&gt;
  fmt_number(columns = c(Events, Time), decimals = 1) |&gt;
  fmt_number(columns = c(AHR, Power, &quot;HR at bound&quot;), decimals = 3) |&gt;
  tab_header(&quot;Table 2: Asymptotic approximations of design operating characteristics&quot;,
    subtitle = &quot;Evaluating final analysis timing&quot;
  )</code></pre>
<div id="qeayjdrzqo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qeayjdrzqo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qeayjdrzqo thead, #qeayjdrzqo tbody, #qeayjdrzqo tfoot, #qeayjdrzqo tr, #qeayjdrzqo td, #qeayjdrzqo th {
  border-style: none;
}

#qeayjdrzqo p {
  margin: 0;
  padding: 0;
}

#qeayjdrzqo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qeayjdrzqo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qeayjdrzqo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qeayjdrzqo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qeayjdrzqo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qeayjdrzqo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qeayjdrzqo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qeayjdrzqo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qeayjdrzqo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qeayjdrzqo .gt_spanner_row {
  border-bottom-style: hidden;
}

#qeayjdrzqo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qeayjdrzqo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qeayjdrzqo .gt_from_md > :first-child {
  margin-top: 0;
}

#qeayjdrzqo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qeayjdrzqo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qeayjdrzqo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qeayjdrzqo .gt_row_group_first td {
  border-top-width: 2px;
}

#qeayjdrzqo .gt_row_group_first th {
  border-top-width: 2px;
}

#qeayjdrzqo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qeayjdrzqo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qeayjdrzqo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qeayjdrzqo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qeayjdrzqo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qeayjdrzqo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qeayjdrzqo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qeayjdrzqo .gt_left {
  text-align: left;
}

#qeayjdrzqo .gt_center {
  text-align: center;
}

#qeayjdrzqo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qeayjdrzqo .gt_font_normal {
  font-weight: normal;
}

#qeayjdrzqo .gt_font_bold {
  font-weight: bold;
}

#qeayjdrzqo .gt_font_italic {
  font-style: italic;
}

#qeayjdrzqo .gt_super {
  font-size: 65%;
}

#qeayjdrzqo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qeayjdrzqo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qeayjdrzqo .gt_indent_1 {
  text-indent: 5px;
}

#qeayjdrzqo .gt_indent_2 {
  text-indent: 10px;
}

#qeayjdrzqo .gt_indent_3 {
  text-indent: 15px;
}

#qeayjdrzqo .gt_indent_4 {
  text-indent: 20px;
}

#qeayjdrzqo .gt_indent_5 {
  text-indent: 25px;
}

#qeayjdrzqo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qeayjdrzqo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="11" class="gt_heading gt_title gt_font_normal" style>Table 2: Asymptotic approximations of design operating characteristics</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="11" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Evaluating final analysis timing</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Scenario">Scenario</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Control-Median">Control Median</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Delay">Delay</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="HR1">HR1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="HR2">HR2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="N">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Events">Events</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Time">Time</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="AHR">AHR</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Power">Power</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="HR-at-bound">HR at bound</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <th colspan="11" class="gt_group_heading" scope="colgroup" id="Event-based">Event-based</th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Event-based  Scenario" class="gt_row gt_left">Original plan</td>
<td headers="Event-based  Control Median" class="gt_row gt_right">12</td>
<td headers="Event-based  Delay" class="gt_row gt_right">4</td>
<td headers="Event-based  HR1" class="gt_row gt_right">1.0</td>
<td headers="Event-based  HR2" class="gt_row gt_right">0.60</td>
<td headers="Event-based  N" class="gt_row gt_right">422</td>
<td headers="Event-based  Events" class="gt_row gt_right">312.0</td>
<td headers="Event-based  Time" class="gt_row gt_right">36.0</td>
<td headers="Event-based  AHR" class="gt_row gt_right">0.692</td>
<td headers="Event-based  Power" class="gt_row gt_right">0.901</td>
<td headers="Event-based  HR at bound" class="gt_row gt_right">0.801</td></tr>
    <tr><td headers="Event-based  Scenario" class="gt_row gt_left">Events accrue faster</td>
<td headers="Event-based  Control Median" class="gt_row gt_right">10</td>
<td headers="Event-based  Delay" class="gt_row gt_right">6</td>
<td headers="Event-based  HR1" class="gt_row gt_right">1.2</td>
<td headers="Event-based  HR2" class="gt_row gt_right">0.50</td>
<td headers="Event-based  N" class="gt_row gt_right">422</td>
<td headers="Event-based  Events" class="gt_row gt_right">312.0</td>
<td headers="Event-based  Time" class="gt_row gt_right">30.6</td>
<td headers="Event-based  AHR" class="gt_row gt_right">0.771</td>
<td headers="Event-based  Power" class="gt_row gt_right">0.630</td>
<td headers="Event-based  HR at bound" class="gt_row gt_right">0.801</td></tr>
    <tr><td headers="Event-based  Scenario" class="gt_row gt_left">Events accrue slower</td>
<td headers="Event-based  Control Median" class="gt_row gt_right">16</td>
<td headers="Event-based  Delay" class="gt_row gt_right">6</td>
<td headers="Event-based  HR1" class="gt_row gt_right">1.0</td>
<td headers="Event-based  HR2" class="gt_row gt_right">0.55</td>
<td headers="Event-based  N" class="gt_row gt_right">422</td>
<td headers="Event-based  Events" class="gt_row gt_right">312.0</td>
<td headers="Event-based  Time" class="gt_row gt_right">47.5</td>
<td headers="Event-based  AHR" class="gt_row gt_right">0.661</td>
<td headers="Event-based  Power" class="gt_row gt_right">0.953</td>
<td headers="Event-based  HR at bound" class="gt_row gt_right">0.801</td></tr>
    <tr><td headers="Event-based  Scenario" class="gt_row gt_left">Proportional hazards</td>
<td headers="Event-based  Control Median" class="gt_row gt_right">12</td>
<td headers="Event-based  Delay" class="gt_row gt_right">4</td>
<td headers="Event-based  HR1" class="gt_row gt_right">0.7</td>
<td headers="Event-based  HR2" class="gt_row gt_right">0.70</td>
<td headers="Event-based  N" class="gt_row gt_right">422</td>
<td headers="Event-based  Events" class="gt_row gt_right">312.0</td>
<td headers="Event-based  Time" class="gt_row gt_right">35.0</td>
<td headers="Event-based  AHR" class="gt_row gt_right">0.700</td>
<td headers="Event-based  Power" class="gt_row gt_right">0.882</td>
<td headers="Event-based  HR at bound" class="gt_row gt_right">0.801</td></tr>
    <tr><td headers="Event-based  Scenario" class="gt_row gt_left">Null hypothesis</td>
<td headers="Event-based  Control Median" class="gt_row gt_right">12</td>
<td headers="Event-based  Delay" class="gt_row gt_right">4</td>
<td headers="Event-based  HR1" class="gt_row gt_right">1.0</td>
<td headers="Event-based  HR2" class="gt_row gt_right">1.00</td>
<td headers="Event-based  N" class="gt_row gt_right">422</td>
<td headers="Event-based  Events" class="gt_row gt_right">312.0</td>
<td headers="Event-based  Time" class="gt_row gt_right">30.1</td>
<td headers="Event-based  AHR" class="gt_row gt_right">1.000</td>
<td headers="Event-based  Power" class="gt_row gt_right">0.025</td>
<td headers="Event-based  HR at bound" class="gt_row gt_right">0.801</td></tr>
    <tr class="gt_group_heading_row">
      <th colspan="11" class="gt_group_heading" scope="colgroup" id="Time-based">Time-based</th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Time-based  Scenario" class="gt_row gt_left">Original plan</td>
<td headers="Time-based  Control Median" class="gt_row gt_right">12</td>
<td headers="Time-based  Delay" class="gt_row gt_right">4</td>
<td headers="Time-based  HR1" class="gt_row gt_right">1.0</td>
<td headers="Time-based  HR2" class="gt_row gt_right">0.60</td>
<td headers="Time-based  N" class="gt_row gt_right">422</td>
<td headers="Time-based  Events" class="gt_row gt_right">312.0</td>
<td headers="Time-based  Time" class="gt_row gt_right">36.0</td>
<td headers="Time-based  AHR" class="gt_row gt_right">0.692</td>
<td headers="Time-based  Power" class="gt_row gt_right">0.901</td>
<td headers="Time-based  HR at bound" class="gt_row gt_right">0.801</td></tr>
    <tr><td headers="Time-based  Scenario" class="gt_row gt_left">Events accrue faster</td>
<td headers="Time-based  Control Median" class="gt_row gt_right">10</td>
<td headers="Time-based  Delay" class="gt_row gt_right">6</td>
<td headers="Time-based  HR1" class="gt_row gt_right">1.2</td>
<td headers="Time-based  HR2" class="gt_row gt_right">0.50</td>
<td headers="Time-based  N" class="gt_row gt_right">422</td>
<td headers="Time-based  Events" class="gt_row gt_right">335.5</td>
<td headers="Time-based  Time" class="gt_row gt_right">36.0</td>
<td headers="Time-based  AHR" class="gt_row gt_right">0.748</td>
<td headers="Time-based  Power" class="gt_row gt_right">0.755</td>
<td headers="Time-based  HR at bound" class="gt_row gt_right">0.807</td></tr>
    <tr><td headers="Time-based  Scenario" class="gt_row gt_left">Events accrue slower</td>
<td headers="Time-based  Control Median" class="gt_row gt_right">16</td>
<td headers="Time-based  Delay" class="gt_row gt_right">6</td>
<td headers="Time-based  HR1" class="gt_row gt_right">1.0</td>
<td headers="Time-based  HR2" class="gt_row gt_right">0.55</td>
<td headers="Time-based  N" class="gt_row gt_right">422</td>
<td headers="Time-based  Events" class="gt_row gt_right">268.5</td>
<td headers="Time-based  Time" class="gt_row gt_right">36.0</td>
<td headers="Time-based  AHR" class="gt_row gt_right">0.682</td>
<td headers="Time-based  Power" class="gt_row gt_right">0.878</td>
<td headers="Time-based  HR at bound" class="gt_row gt_right">0.787</td></tr>
    <tr><td headers="Time-based  Scenario" class="gt_row gt_left">Proportional hazards</td>
<td headers="Time-based  Control Median" class="gt_row gt_right">12</td>
<td headers="Time-based  Delay" class="gt_row gt_right">4</td>
<td headers="Time-based  HR1" class="gt_row gt_right">0.7</td>
<td headers="Time-based  HR2" class="gt_row gt_right">0.70</td>
<td headers="Time-based  N" class="gt_row gt_right">422</td>
<td headers="Time-based  Events" class="gt_row gt_right">317.0</td>
<td headers="Time-based  Time" class="gt_row gt_right">36.0</td>
<td headers="Time-based  AHR" class="gt_row gt_right">0.700</td>
<td headers="Time-based  Power" class="gt_row gt_right">0.887</td>
<td headers="Time-based  HR at bound" class="gt_row gt_right">0.802</td></tr>
    <tr><td headers="Time-based  Scenario" class="gt_row gt_left">Null hypothesis</td>
<td headers="Time-based  Control Median" class="gt_row gt_right">12</td>
<td headers="Time-based  Delay" class="gt_row gt_right">4</td>
<td headers="Time-based  HR1" class="gt_row gt_right">1.0</td>
<td headers="Time-based  HR2" class="gt_row gt_right">1.00</td>
<td headers="Time-based  N" class="gt_row gt_right">422</td>
<td headers="Time-based  Events" class="gt_row gt_right">342.2</td>
<td headers="Time-based  Time" class="gt_row gt_right">36.0</td>
<td headers="Time-based  AHR" class="gt_row gt_right">1.000</td>
<td headers="Time-based  Power" class="gt_row gt_right">0.025</td>
<td headers="Time-based  HR at bound" class="gt_row gt_right">0.809</td></tr>
    <tr class="gt_group_heading_row">
      <th colspan="11" class="gt_group_heading" scope="colgroup" id="Max of time- and event-cutoff">Max of time- and event-cutoff</th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Max of time- and event-cutoff  Scenario" class="gt_row gt_left">Original plan</td>
<td headers="Max of time- and event-cutoff  Control Median" class="gt_row gt_right">12</td>
<td headers="Max of time- and event-cutoff  Delay" class="gt_row gt_right">4</td>
<td headers="Max of time- and event-cutoff  HR1" class="gt_row gt_right">1.0</td>
<td headers="Max of time- and event-cutoff  HR2" class="gt_row gt_right">0.60</td>
<td headers="Max of time- and event-cutoff  N" class="gt_row gt_right">422</td>
<td headers="Max of time- and event-cutoff  Events" class="gt_row gt_right">312.0</td>
<td headers="Max of time- and event-cutoff  Time" class="gt_row gt_right">36.0</td>
<td headers="Max of time- and event-cutoff  AHR" class="gt_row gt_right">0.692</td>
<td headers="Max of time- and event-cutoff  Power" class="gt_row gt_right">0.901</td>
<td headers="Max of time- and event-cutoff  HR at bound" class="gt_row gt_right">0.801</td></tr>
    <tr><td headers="Max of time- and event-cutoff  Scenario" class="gt_row gt_left">Events accrue faster</td>
<td headers="Max of time- and event-cutoff  Control Median" class="gt_row gt_right">10</td>
<td headers="Max of time- and event-cutoff  Delay" class="gt_row gt_right">6</td>
<td headers="Max of time- and event-cutoff  HR1" class="gt_row gt_right">1.2</td>
<td headers="Max of time- and event-cutoff  HR2" class="gt_row gt_right">0.50</td>
<td headers="Max of time- and event-cutoff  N" class="gt_row gt_right">422</td>
<td headers="Max of time- and event-cutoff  Events" class="gt_row gt_right">335.5</td>
<td headers="Max of time- and event-cutoff  Time" class="gt_row gt_right">36.0</td>
<td headers="Max of time- and event-cutoff  AHR" class="gt_row gt_right">0.748</td>
<td headers="Max of time- and event-cutoff  Power" class="gt_row gt_right">0.755</td>
<td headers="Max of time- and event-cutoff  HR at bound" class="gt_row gt_right">0.807</td></tr>
    <tr><td headers="Max of time- and event-cutoff  Scenario" class="gt_row gt_left">Events accrue slower</td>
<td headers="Max of time- and event-cutoff  Control Median" class="gt_row gt_right">16</td>
<td headers="Max of time- and event-cutoff  Delay" class="gt_row gt_right">6</td>
<td headers="Max of time- and event-cutoff  HR1" class="gt_row gt_right">1.0</td>
<td headers="Max of time- and event-cutoff  HR2" class="gt_row gt_right">0.55</td>
<td headers="Max of time- and event-cutoff  N" class="gt_row gt_right">422</td>
<td headers="Max of time- and event-cutoff  Events" class="gt_row gt_right">312.0</td>
<td headers="Max of time- and event-cutoff  Time" class="gt_row gt_right">47.5</td>
<td headers="Max of time- and event-cutoff  AHR" class="gt_row gt_right">0.661</td>
<td headers="Max of time- and event-cutoff  Power" class="gt_row gt_right">0.953</td>
<td headers="Max of time- and event-cutoff  HR at bound" class="gt_row gt_right">0.801</td></tr>
    <tr><td headers="Max of time- and event-cutoff  Scenario" class="gt_row gt_left">Proportional hazards</td>
<td headers="Max of time- and event-cutoff  Control Median" class="gt_row gt_right">12</td>
<td headers="Max of time- and event-cutoff  Delay" class="gt_row gt_right">4</td>
<td headers="Max of time- and event-cutoff  HR1" class="gt_row gt_right">0.7</td>
<td headers="Max of time- and event-cutoff  HR2" class="gt_row gt_right">0.70</td>
<td headers="Max of time- and event-cutoff  N" class="gt_row gt_right">422</td>
<td headers="Max of time- and event-cutoff  Events" class="gt_row gt_right">317.0</td>
<td headers="Max of time- and event-cutoff  Time" class="gt_row gt_right">36.0</td>
<td headers="Max of time- and event-cutoff  AHR" class="gt_row gt_right">0.700</td>
<td headers="Max of time- and event-cutoff  Power" class="gt_row gt_right">0.887</td>
<td headers="Max of time- and event-cutoff  HR at bound" class="gt_row gt_right">0.802</td></tr>
    <tr><td headers="Max of time- and event-cutoff  Scenario" class="gt_row gt_left">Null hypothesis</td>
<td headers="Max of time- and event-cutoff  Control Median" class="gt_row gt_right">12</td>
<td headers="Max of time- and event-cutoff  Delay" class="gt_row gt_right">4</td>
<td headers="Max of time- and event-cutoff  HR1" class="gt_row gt_right">1.0</td>
<td headers="Max of time- and event-cutoff  HR2" class="gt_row gt_right">1.00</td>
<td headers="Max of time- and event-cutoff  N" class="gt_row gt_right">422</td>
<td headers="Max of time- and event-cutoff  Events" class="gt_row gt_right">342.2</td>
<td headers="Max of time- and event-cutoff  Time" class="gt_row gt_right">36.0</td>
<td headers="Max of time- and event-cutoff  AHR" class="gt_row gt_right">1.000</td>
<td headers="Max of time- and event-cutoff  Power" class="gt_row gt_right">0.025</td>
<td headers="Max of time- and event-cutoff  HR at bound" class="gt_row gt_right">0.809</td></tr>
  </tbody>
  
  
</table>
</div>
<div id="simulation-of-fixed-design" class="section level3">
<h3>Simulation of fixed design</h3>
<p>We use simulation to verify the power approximations above as well as whether
Type I error is controlled at the targeted one-sided 2.5%.
Table 3 shows that with <span class="math inline">\(10^{5}\)</span> simulated trials, the computations from Table 2
provide good approximations.
The <code>SE(Power)</code> provides the standard error for the simulation power approximation
for each scenario as a measure of accuracy.
The average in the HR column is the geometric average of the Cox regression
estimate of the hazard ratio.</p>
<pre class="r"><code>if (run_simulations) {
  sim_summary &lt;- NULL
  tic(paste(&quot;Fixed design simulation duration for&quot;, nsim, &quot;simulated trials&quot;))
  for (i in seq_along(scenarios$i)) {
    # Get failure rate and event rate assumptions from scenario i = 1
    rates &lt;- define_fail_rate(
      duration = c(scenarios$Delay[i], 100),
      fail_rate = log(2) / scenarios$ControlMedian[i],
      hr = c(scenarios$hr1[i], scenarios$hr2[i]),
      dropout_rate = dropoutRate
    )
    # Run a simulation for power
    sim &lt;- sim_fixed_n(
      n_sim = nsim,
      enroll_rate = xx$enroll_rate,
      sample_size = max(xx$analysis$n),
      target_event = max(xx$analysis$event),
      total_duration = max(xx$analysis$time),
      fail_rate = rates
    )

    # Summarize results
    sim_summary &lt;- rbind(
      sim_summary,
      sim |&gt; select(-names(sim)[1:4]) |&gt; group_by(cut) |&gt;
        summarise(
          Scenario = scenarios$Scenario[i], Simulations = nsim,
          Power = mean(z &gt;= qnorm(0.975)),
          &quot;SE(Power)&quot; = sd(z &gt;= qnorm(0.975)) / sqrt(nsim),
          HR = exp(mean(ln_hr)), &quot;E(Duration)&quot; = mean(duration),
          &quot;SD(Duration)&quot; = sd(duration), &quot;E(Events)&quot; = mean(event),
          &quot;SD(Events)&quot; = sd(event)
        )
    )
  }
  save(sim_summary, file = &quot;FixedDesignSimulation.RData&quot;)
  toc()
} else {
  load(&quot;FixedDesignSimulation.RData&quot;)
}</code></pre>
<pre><code>#&gt; Fixed design simulation duration for 1e+05 simulated trials: 819 sec elapsed</code></pre>
<pre class="r"><code>sim_summary |&gt;
  transmute(
    Scenario = factor(Scenario),
    Cut = factor(cut),
    Power = round(Power, 4),
    &quot;SE(Power)&quot; = round(`SE(Power)`, 4),
    HR = round(HR, 3),
    &quot;E(Duration)&quot; = round(`E(Duration)`, 1),
    &quot;SD(Duration)&quot; = round(`SD(Duration)`, 1),
    &quot;E(Events)&quot; = round(`E(Events)`, 1),
    &quot;SD(Events)&quot; = round(`SD(Events)`, 1)
  ) |&gt;
  group_by(Cut) |&gt;
  datatable(
    options = list(
      pageLength = 5,
      autoWidth = TRUE,
      columnDefs = list(list(className = &quot;dt-center&quot;, targets = &quot;_all&quot;))
    ),
    filter = &quot;top&quot;,
    caption = &quot;Table 3: Simulation results by scenario and data cutoff method&quot;
  )</code></pre>
<div class="datatables html-widget html-fill-item" id="htmlwidget-2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Events accrue faster&quot;,&quot;Events accrue slower&quot;,&quot;Null hypothesis&quot;,&quot;Original plan&quot;,&quot;Proportional hazards&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Max(min follow-up, event cut)&quot;,&quot;Max(planned duration, event cut)&quot;,&quot;Minimum follow-up&quot;,&quot;Planned duration&quot;,&quot;Targeted events&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.0244\" data-max=\"0.9484\" data-scale=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"5e-04\" data-max=\"0.0015\" data-scale=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.663\" data-max=\"1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"30\" data-max=\"47.5\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"2.9\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"268.4\" data-max=\"342.1\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"9.8\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>Table 3: Simulation results by scenario and data cutoff method<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],["Original plan","Original plan","Original plan","Original plan","Original plan","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis"],["Max(min follow-up, event cut)","Max(planned duration, event cut)","Minimum follow-up","Planned duration","Targeted events","Max(min follow-up, event cut)","Max(planned duration, event cut)","Minimum follow-up","Planned duration","Targeted events","Max(min follow-up, event cut)","Max(planned duration, event cut)","Minimum follow-up","Planned duration","Targeted events","Max(min follow-up, event cut)","Max(planned duration, event cut)","Minimum follow-up","Planned duration","Targeted events","Max(min follow-up, event cut)","Max(planned duration, event cut)","Minimum follow-up","Planned duration","Targeted events"],[0.9031,0.9034,0.8981,0.8986,0.8955,0.7362,0.7359,0.7362,0.7359,0.6037,0.9484,0.9484,0.8744,0.8739,0.9484,0.8891,0.8891,0.8882,0.8881,0.8822,0.0244,0.0245,0.0244,0.0245,0.0246],[0.0009,0.0009,0.001,0.001,0.001,0.0014,0.0014,0.0014,0.0014,0.0015,0.0007,0.0007,0.001,0.001,0.0007,0.001,0.001,0.001,0.001,0.001,0.0005,0.0005,0.0005,0.0005,0.0005],[0.6909999999999999,0.6909999999999999,0.6919999999999999,0.6919999999999999,0.6929999999999999,0.752,0.752,0.752,0.752,0.775,0.663,0.663,0.6830000000000001,0.6830000000000001,0.663,0.699,0.699,0.699,0.699,0.7,1,1,1,1,1],[36.8,36.8,36,36,35.9,36,36,36,36,30.5,47.5,47.5,36,36,47.5,36.3,36.3,36,36,34.9,36,36,36,36,30],[1.3,1.2,0.6,0,2,0.6,0,0.6,0,1.8,2.9,2.9,0.6,0,2.9,0.9,0.7,0.6,0,1.8,0.6,0,0.6,0,1.5],[315.5,315.5,311.9,311.9,312,335.4,335.3,335.3,335.3,312,312,312,268.4,268.4,312,318.5,318.5,316.9,316.9,312,342.1,342.1,342.1,342.1,312],[5.1,5.2,9,9,0,8.199999999999999,8.300000000000001,8.300000000000001,8.300000000000001,0,0,0,9.800000000000001,9.800000000000001,0,6.6,6.7,8.800000000000001,8.9,0,8.1,8.1,8.1,8.1,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Scenario<\/th>\n      <th>Cut<\/th>\n      <th>Power<\/th>\n      <th>SE(Power)<\/th>\n      <th>HR<\/th>\n      <th>E(Duration)<\/th>\n      <th>SD(Duration)<\/th>\n      <th>E(Events)<\/th>\n      <th>SD(Events)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"autoWidth":true,"columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Scenario","targets":1},{"name":"Cut","targets":2},{"name":"Power","targets":3},{"name":"SE(Power)","targets":4},{"name":"HR","targets":5},{"name":"E(Duration)","targets":6},{"name":"SD(Duration)","targets":7},{"name":"E(Events)","targets":8},{"name":"SD(Events)","targets":9}],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># gt() |&gt;
#   fmt_number(columns = c(HR, &quot;Power&quot;, &quot;SE(Power)&quot;), decimals = 3) |&gt;
#   fmt_number(columns = c(&quot;E(Duration)&quot;, &quot;SD(Duration)&quot;, &quot;E(Events)&quot;, &quot;SD(Events)&quot;), decimals = 1) |&gt;
#   tab_header(title = &quot;Table 3: Simulation results by scenario and data cutoff method&quot;)</code></pre>
<p>Simulations were performed with the <code>simtrial::sim_fixed_n()</code> function using
parallel computing with 32 CPUs. While the user sets up the
number of CPU cores used and parallel backend, the parallel computing is
otherwise implemented automatically by <code>simtrial::sim_fixed_n()</code>.</p>
</div>
</div>
<div id="group-sequential-design" class="section level2">
<h2>Group sequential design</h2>
<p>Now we derive the planned design with the <em>Original plan</em> assumptions above.
The design has the following additional characteristics.
Other than the group sequential assumptions, these are the same as for the
fixed design above.</p>
<ul>
<li>An exponential dropout rate of 0.001 in both treatment groups.</li>
<li>A constant random enrollment rate is planned for 12 months;
piecewise constant enrollment is also an option in the software.</li>
<li>Planned analysis times at 20, 28, and 36 months.</li>
<li>Spending is based on the information fraction at the planned analysis times
using a Lan-DeMets spending function to approximate the O’Brien-Fleming spending function.</li>
<li>One-sided testing only no futility bound.</li>
<li>Sample size rounded to an even number, event counts rounded to the
nearest integer for interim analyses and rounded up for the final analysis.</li>
</ul>
<pre class="r"><code># Failure rates from 1st scenario for design
failRates &lt;- define_fail_rate(
  duration = c(scenarios$Delay[1], 100),
  fail_rate = log(2) / scenarios$ControlMedian[1],
  hr = c(scenarios$hr1[1], scenarios$hr2[1]),
  dropout_rate = dropoutRate
)
upar_design &lt;- list(sf = gsDesign::sfLDOF, total_spend = alpha)
# Find sample size for 36 month trial under given
# enrollment and sample size assumptions
# Interim at planned information fraction
xx &lt;- gs_design_ahr(
  enroll_rate = enrollRates,
  fail_rate = failRates,
  analysis_time = c(20, 28, 36),
  # analysisTimes,
  info_frac = NULL,
  # planned_IF,
  upper = gs_spending_bound,
  upar = upar_design,
  lpar = rep(-Inf, 3),
  lower = gs_b,
  test_lower = FALSE,
  beta = beta,
  alpha = alpha
) |&gt; to_integer()</code></pre>
<p>The planned analyses and bounds are in the table below. In spite of two
interim analyses with 0.66 and 0.86 of the final planned observations,
the O’Brien-Fleming spending approach preserves enough <span class="math inline">\(\alpha\)</span> for the
final analysis to be tested at a nominal 0.0201 level.
While the 0.86 information fraction at the final interim may seem high,
the intent to do analyses every 8 months starting at month 20 dictates this.
At the final analysis, a hazard ratio of approximately 0.79 or smaller
is required for a positive finding. Under the alternate hypothesis,
there is a substantial probability of crossing an efficacy bound prior to
the final analysis as indicated by the cumulative power of 0.35 at the
first interim analysis and 0.75 at the second. We see that the expected
geometric mean of the observed hazard ratio (AHR) decreases from 0.74 at
the first interim to 0.71 at the second, and 0.69 at the final analysis.
Thus, the longer the trial continues, the strong the expected treatment effect is.
We will see that continuing the trial long enough for the expected
treatment effect to be strong is important in the scenarios that follow.</p>
<pre class="r"><code>xx |&gt;
  summary() |&gt;
  as_gt(
    title = &quot;Group sequential design based on original assumptions&quot;,
    subtitle = &quot;Table 4: Delayed effect for 4 months, HR = 0.6 thereafter&quot;
  )</code></pre>
<div id="ciydemetbh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ciydemetbh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ciydemetbh thead, #ciydemetbh tbody, #ciydemetbh tfoot, #ciydemetbh tr, #ciydemetbh td, #ciydemetbh th {
  border-style: none;
}

#ciydemetbh p {
  margin: 0;
  padding: 0;
}

#ciydemetbh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ciydemetbh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ciydemetbh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ciydemetbh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ciydemetbh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ciydemetbh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ciydemetbh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ciydemetbh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ciydemetbh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ciydemetbh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ciydemetbh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ciydemetbh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ciydemetbh .gt_spanner_row {
  border-bottom-style: hidden;
}

#ciydemetbh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ciydemetbh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ciydemetbh .gt_from_md > :first-child {
  margin-top: 0;
}

#ciydemetbh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ciydemetbh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ciydemetbh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ciydemetbh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ciydemetbh .gt_row_group_first td {
  border-top-width: 2px;
}

#ciydemetbh .gt_row_group_first th {
  border-top-width: 2px;
}

#ciydemetbh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ciydemetbh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ciydemetbh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ciydemetbh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ciydemetbh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ciydemetbh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ciydemetbh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ciydemetbh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ciydemetbh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ciydemetbh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ciydemetbh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ciydemetbh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ciydemetbh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ciydemetbh .gt_left {
  text-align: left;
}

#ciydemetbh .gt_center {
  text-align: center;
}

#ciydemetbh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ciydemetbh .gt_font_normal {
  font-weight: normal;
}

#ciydemetbh .gt_font_bold {
  font-weight: bold;
}

#ciydemetbh .gt_font_italic {
  font-style: italic;
}

#ciydemetbh .gt_super {
  font-size: 65%;
}

#ciydemetbh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ciydemetbh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ciydemetbh .gt_indent_1 {
  text-indent: 5px;
}

#ciydemetbh .gt_indent_2 {
  text-indent: 10px;
}

#ciydemetbh .gt_indent_3 {
  text-indent: 15px;
}

#ciydemetbh .gt_indent_4 {
  text-indent: 20px;
}

#ciydemetbh .gt_indent_5 {
  text-indent: 25px;
}

#ciydemetbh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ciydemetbh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_title gt_font_normal" style>Group sequential design based on original assumptions</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Table 4: Delayed effect for 4 months, HR = 0.6 thereafter</td>
    </tr>
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Bound">Bound</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Z">Z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Nominal-p">Nominal p<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="a~HR-at-bound">~HR at bound<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Cumulative boundary crossing probability">
        <div class="gt_column_spanner">Cumulative boundary crossing probability</div>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Alternate-hypothesis">Alternate hypothesis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Null-hypothesis">Null hypothesis</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.74 Information fraction: 0.66">Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.74 Information fraction: 0.66</th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.74 Information fraction: 0.66  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.74 Information fraction: 0.66  Z" class="gt_row gt_right">2.53</td>
<td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.74 Information fraction: 0.66  Nominal p" class="gt_row gt_right">0.0057</td>
<td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.74 Information fraction: 0.66  ~HR at bound" class="gt_row gt_right">0.7046</td>
<td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.74 Information fraction: 0.66  Alternate hypothesis" class="gt_row gt_right">0.3454</td>
<td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.74 Information fraction: 0.66  Null hypothesis" class="gt_row gt_right">0.0057</td></tr>
    <tr class="gt_group_heading_row">
      <th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.71 Information fraction: 0.86">Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.71 Information fraction: 0.86</th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.71 Information fraction: 0.86  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.71 Information fraction: 0.86  Z" class="gt_row gt_right">2.20</td>
<td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.71 Information fraction: 0.86  Nominal p" class="gt_row gt_right">0.0138</td>
<td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.71 Information fraction: 0.86  ~HR at bound" class="gt_row gt_right">0.7661</td>
<td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.71 Information fraction: 0.86  Alternate hypothesis" class="gt_row gt_right">0.7453</td>
<td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.71 Information fraction: 0.86  Null hypothesis" class="gt_row gt_right">0.0156</td></tr>
    <tr class="gt_group_heading_row">
      <th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.69 Information fraction: 1">Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.69 Information fraction: 1</th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.69 Information fraction: 1  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.69 Information fraction: 1  Z" class="gt_row gt_right">2.05</td>
<td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.69 Information fraction: 1  Nominal p" class="gt_row gt_right">0.0201</td>
<td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.69 Information fraction: 1  ~HR at bound" class="gt_row gt_right">0.7944</td>
<td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.69 Information fraction: 1  Alternate hypothesis" class="gt_row gt_right">0.9009</td>
<td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.69 Information fraction: 1  Null hypothesis" class="gt_row gt_right">0.0250</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> One-sided p-value for experimental vs control treatment. Value &lt; 0.5 favors experimental, &gt; 0.5 favors control.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Approximate hazard ratio to cross bound.</td>
    </tr>
  </tfoot>
</table>
</div>
<div id="same-design-with-weighted-logrank" class="section level3">
<h3>Same design with weighted logrank</h3>
<p>We consider the same sample size and analysis timing but using the
modestly weighted logrank (MWLR) test of <span class="citation">Magirr and Burman (<a href="#ref-magirr2019modestly">2019</a>)</span>.
Weights increase from 1 at time 0 to a maximum of 2 at the combined
treatment group median and beyond.
We see that power is higher than for the unweighted logrank above.
Note that due to the higher weighting of later failures,
the information fraction is lower for interim analyses than when
using the logrank test above.
Thus, the increased power relative to the logrank test above is due
both to the weighting and spending changes.</p>
<pre class="r"><code>gs_arm &lt;- gs_create_arm(xx$enroll_rate, xx$fail_rate, xx$ratio)
mb_design &lt;- gs_power_wlr(
  enroll_rate = xx$enroll_rate,
  fail_rate = xx$fail_rate,
  analysis_time = xx$analysis$time,
  # Magirr-Burman weighting for MWLR
  weight = list(method = &quot;mb&quot;, param = list(tau = NULL, w_max = 2)),
  upper = gs_spending_bound,
  upar = upar_design,
  lpar = rep(-Inf, 3),
  lower = gs_b,
  test_lower = FALSE
) |&gt; to_integer()</code></pre>
<pre class="r"><code>mb_design |&gt;
  summary() |&gt;
  as_gt(
    title = &quot;Group sequential design based on original assumptions&quot;,
    subtitle = &quot;Table 5: Testing with MWLR using maximum weight of 2&quot;
  )</code></pre>
<div id="czajxkovzh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#czajxkovzh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#czajxkovzh thead, #czajxkovzh tbody, #czajxkovzh tfoot, #czajxkovzh tr, #czajxkovzh td, #czajxkovzh th {
  border-style: none;
}

#czajxkovzh p {
  margin: 0;
  padding: 0;
}

#czajxkovzh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#czajxkovzh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#czajxkovzh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#czajxkovzh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#czajxkovzh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#czajxkovzh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czajxkovzh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#czajxkovzh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#czajxkovzh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#czajxkovzh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#czajxkovzh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#czajxkovzh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#czajxkovzh .gt_spanner_row {
  border-bottom-style: hidden;
}

#czajxkovzh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#czajxkovzh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#czajxkovzh .gt_from_md > :first-child {
  margin-top: 0;
}

#czajxkovzh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#czajxkovzh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#czajxkovzh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#czajxkovzh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#czajxkovzh .gt_row_group_first td {
  border-top-width: 2px;
}

#czajxkovzh .gt_row_group_first th {
  border-top-width: 2px;
}

#czajxkovzh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#czajxkovzh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#czajxkovzh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#czajxkovzh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czajxkovzh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#czajxkovzh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#czajxkovzh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#czajxkovzh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#czajxkovzh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czajxkovzh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#czajxkovzh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#czajxkovzh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#czajxkovzh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#czajxkovzh .gt_left {
  text-align: left;
}

#czajxkovzh .gt_center {
  text-align: center;
}

#czajxkovzh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#czajxkovzh .gt_font_normal {
  font-weight: normal;
}

#czajxkovzh .gt_font_bold {
  font-weight: bold;
}

#czajxkovzh .gt_font_italic {
  font-style: italic;
}

#czajxkovzh .gt_super {
  font-size: 65%;
}

#czajxkovzh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#czajxkovzh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#czajxkovzh .gt_indent_1 {
  text-indent: 5px;
}

#czajxkovzh .gt_indent_2 {
  text-indent: 10px;
}

#czajxkovzh .gt_indent_3 {
  text-indent: 15px;
}

#czajxkovzh .gt_indent_4 {
  text-indent: 20px;
}

#czajxkovzh .gt_indent_5 {
  text-indent: 25px;
}

#czajxkovzh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#czajxkovzh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_title gt_font_normal" style>Group sequential design based on original assumptions</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Table 5: Testing with MWLR using maximum weight of 2</td>
    </tr>
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Bound">Bound</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Z">Z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="Nominal-p">Nominal p<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="a~wHR-at-bound">~wHR at bound<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Cumulative boundary crossing probability">
        <div class="gt_column_spanner">Cumulative boundary crossing probability</div>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Alternate-hypothesis">Alternate hypothesis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Null-hypothesis">Null hypothesis</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.72 Information fraction: 0.49&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/span&gt;">Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.72 Information fraction: 0.49<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.72 Information fraction: 0.49  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.72 Information fraction: 0.49  Z" class="gt_row gt_right">2.99</td>
<td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.72 Information fraction: 0.49  Nominal p" class="gt_row gt_right">0.0014</td>
<td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.72 Information fraction: 0.49  ~wHR at bound" class="gt_row gt_right">0.6615</td>
<td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.72 Information fraction: 0.49  Alternate hypothesis" class="gt_row gt_right">0.2725</td>
<td headers="Analysis: 1 Time: 19.9 N: 430 Events: 209 AHR: 0.72 Information fraction: 0.49  Null hypothesis" class="gt_row gt_right">0.0014</td></tr>
    <tr class="gt_group_heading_row">
      <th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.68 Information fraction: 0.78&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/span&gt;">Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.68 Information fraction: 0.78<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.68 Information fraction: 0.78  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.68 Information fraction: 0.78  Z" class="gt_row gt_right">2.29</td>
<td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.68 Information fraction: 0.78  Nominal p" class="gt_row gt_right">0.0109</td>
<td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.68 Information fraction: 0.78  ~wHR at bound" class="gt_row gt_right">0.7577</td>
<td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.68 Information fraction: 0.78  Alternate hypothesis" class="gt_row gt_right">0.8043</td>
<td headers="Analysis: 2 Time: 27.9 N: 430 Events: 273 AHR: 0.68 Information fraction: 0.78  Null hypothesis" class="gt_row gt_right">0.0114</td></tr>
    <tr class="gt_group_heading_row">
      <th colspan="6" class="gt_group_heading" scope="colgroup" id="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.66 Information fraction: 1&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;&quot;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/span&gt;">Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.66 Information fraction: 1<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.66 Information fraction: 1  Bound" class="gt_row gt_left">Efficacy</td>
<td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.66 Information fraction: 1  Z" class="gt_row gt_right">2.02</td>
<td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.66 Information fraction: 1  Nominal p" class="gt_row gt_right">0.0215</td>
<td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.66 Information fraction: 1  ~wHR at bound" class="gt_row gt_right">0.7970</td>
<td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.66 Information fraction: 1  Alternate hypothesis" class="gt_row gt_right">0.9492</td>
<td headers="Analysis: 3 Time: 36 N: 430 Events: 318 AHR: 0.66 Information fraction: 1  Null hypothesis" class="gt_row gt_right">0.0250</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> One-sided p-value for experimental vs control treatment. Value &lt; 0.5 favors experimental, &gt; 0.5 favors control.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Approximate hazard ratio to cross bound.</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> wAHR is the weighted AHR.</td>
    </tr>
  </tfoot>
</table>
</div>
<p>We check that the cumulative <span class="math inline">\(\alpha\)</span>-spending at each analysis is as expected:</p>
<pre class="r"><code>sfLDOF(alpha = 0.025, t = mb_design$analysis$info_frac0)$spend</code></pre>
<pre><code>#&gt; [1] 0.001409526 0.011392119 0.025000000</code></pre>
</div>
</div>
<div id="accumulation-of-events-and-average-treatment-effect-over-time" class="section level2">
<h2>Accumulation of events and average treatment effect over time</h2>
<p>In addition to the different failure rate scenarios, we consider 3
enrollment scenarios to achieve the targeted sample size:</p>
<ul>
<li>The original design assumptions.</li>
<li>A rate 50% higher than the original design, with 4 months less time for the
expected sample size to reach the target.</li>
<li>A rate 25% lower than the original design with 4 months more time for the
expected sample size to reach the target.</li>
</ul>
<pre class="r"><code>enroll_rate_scenarios &lt;- rbind(
  define_enroll_rate(duration = 12, rate = xx$enroll_rate$rate[1]) |&gt;
    mutate(Enrollment = &quot;Original&quot;),
  define_enroll_rate(duration = 8, rate = 1.5 * xx$enroll_rate$rate[1]) |&gt;
    mutate(Enrollment = &quot;Faster&quot;),
  define_enroll_rate(duration = 16, rate = 0.75 * xx$enroll_rate$rate[1]) |&gt;
    mutate(Enrollment = &quot;Slower&quot;)
)
enroll_rate_scenarios |&gt;
  select(-stratum) |&gt;
  gt() |&gt;
  tab_header(title = &quot;Table 6: Enrollment rate scenarios&quot;) |&gt;
  fmt_number(columns = &quot;rate&quot;, decimals = 1) |&gt;
  cols_label(
    duration = &quot;Target duration (months)&quot;, rate = &quot;Enrollment rate per month&quot;,
    Enrollment = &quot;Scenario&quot;
  )</code></pre>
<div id="ddvrmedbxr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ddvrmedbxr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ddvrmedbxr thead, #ddvrmedbxr tbody, #ddvrmedbxr tfoot, #ddvrmedbxr tr, #ddvrmedbxr td, #ddvrmedbxr th {
  border-style: none;
}

#ddvrmedbxr p {
  margin: 0;
  padding: 0;
}

#ddvrmedbxr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ddvrmedbxr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ddvrmedbxr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ddvrmedbxr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ddvrmedbxr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ddvrmedbxr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ddvrmedbxr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ddvrmedbxr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ddvrmedbxr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ddvrmedbxr .gt_spanner_row {
  border-bottom-style: hidden;
}

#ddvrmedbxr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ddvrmedbxr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ddvrmedbxr .gt_from_md > :first-child {
  margin-top: 0;
}

#ddvrmedbxr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ddvrmedbxr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ddvrmedbxr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ddvrmedbxr .gt_row_group_first td {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_row_group_first th {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ddvrmedbxr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ddvrmedbxr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ddvrmedbxr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ddvrmedbxr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ddvrmedbxr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ddvrmedbxr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ddvrmedbxr .gt_left {
  text-align: left;
}

#ddvrmedbxr .gt_center {
  text-align: center;
}

#ddvrmedbxr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ddvrmedbxr .gt_font_normal {
  font-weight: normal;
}

#ddvrmedbxr .gt_font_bold {
  font-weight: bold;
}

#ddvrmedbxr .gt_font_italic {
  font-style: italic;
}

#ddvrmedbxr .gt_super {
  font-size: 65%;
}

#ddvrmedbxr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ddvrmedbxr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ddvrmedbxr .gt_indent_1 {
  text-indent: 5px;
}

#ddvrmedbxr .gt_indent_2 {
  text-indent: 10px;
}

#ddvrmedbxr .gt_indent_3 {
  text-indent: 15px;
}

#ddvrmedbxr .gt_indent_4 {
  text-indent: 20px;
}

#ddvrmedbxr .gt_indent_5 {
  text-indent: 25px;
}

#ddvrmedbxr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ddvrmedbxr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Table 6: Enrollment rate scenarios</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="duration">Target duration (months)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rate">Enrollment rate per month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Enrollment">Scenario</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="duration" class="gt_row gt_right">12</td>
<td headers="rate" class="gt_row gt_right">35.8</td>
<td headers="Enrollment" class="gt_row gt_left">Original</td></tr>
    <tr><td headers="duration" class="gt_row gt_right">8</td>
<td headers="rate" class="gt_row gt_right">53.7</td>
<td headers="Enrollment" class="gt_row gt_left">Faster</td></tr>
    <tr><td headers="duration" class="gt_row gt_right">16</td>
<td headers="rate" class="gt_row gt_right">26.9</td>
<td headers="Enrollment" class="gt_row gt_left">Slower</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Now we compute expected events and average hazard ratio over time for each
enrollment and event rate scenario.
We see that for the higher event rate scenario events may accrue closer to
30 months rather than the planned 36 months (Figures A and C).
For faster enrollment rates, the delayed effect as evidenced by
average hazard ratio (AHR) is exaggerated (Figures B and C).
The average hazard ratio appears to have an important decrease (improvement)
still between 30 and 36 months (Figure B), suggesting it could be advantageous
to have the trial continue for at least 36 months.
For lower than planned event rates, it appears important to extend the trial
past 36 months to accrue the targeted events.</p>
<pre class="r"><code>output &lt;- NULL
for (i in 1:nrow(scenarios)) {
  # Set failure rates
  failRates &lt;- define_fail_rate(
    duration = c(scenarios$Delay[i], 100),
    fail_rate = log(2) / scenarios$ControlMedian[i],
    hr = c(scenarios$hr1[i], scenarios$hr2[i]),
    dropout_rate = dropoutRate
  )
  for (j in 1:nrow(enroll_rate_scenarios)) {
    # Find sample size for 30 month trial under given
    # enrollment and sample size assumptions
    yy &lt;- ahr(
      enroll_rate = enroll_rate_scenarios[j, ],
      fail_rate = failRates,
      total_duration = c(0.001, 1:48),
      ratio = 1
    ) |&gt;
      mutate(
        Enrollment = enroll_rate_scenarios$Enrollment[j],
        Scenario = scenarios$Scenario[i]
      )
    output &lt;- rbind(output, yy)
  }
}</code></pre>
<pre class="r"><code>p1 &lt;- output |&gt; ggplot(aes(x = time, y = event, color = Scenario, lty = Enrollment)) +
  geom_line() +
  geom_hline(yintercept = max(xx$analysis$event), linetype = &quot;dashed&quot;) +
  scale_x_continuous(breaks = seq(0, 48, 12)) +
  guides(lty = &quot;none&quot;, color = &quot;none&quot;) +
  ggsci::scale_color_futurama() +
  ylab(&quot;Expected events&quot;) +
  xlab(&quot;Month&quot;)

p2 &lt;- output |&gt; ggplot(aes(x = time, y = ahr, color = Scenario, lty = Enrollment)) +
  geom_line() +
  scale_x_continuous(breaks = seq(0, 48, 12)) +
  guides(lty = &quot;none&quot;, color = &quot;none&quot;) +
  ggsci::scale_color_futurama() +
  ylab(&quot;Average hazard ratio&quot;) +
  xlab(&quot;Month&quot;)

p3 &lt;- output |&gt; ggplot(aes(x = event, y = ahr, color = Scenario, lty = Enrollment)) +
  geom_line() +
  geom_vline(xintercept = max(xx$analysis$event), linetype = &quot;dashed&quot;) +
  ggsci::scale_color_futurama() +
  guides(color = guide_legend(title = &quot;Failure rate&quot;)) +
  ylab(&quot;Average hazard ratio&quot;) +
  xlab(&quot;Expected events&quot;) +
  theme(legend.position = &quot;right&quot;)</code></pre>
<pre class="r"><code>top_row &lt;- cowplot::plot_grid(p1, p2, labels = c(&quot;A&quot;, &quot;B&quot;), label_size = 12)

cowplot::plot_grid(top_row, p3,
  labels = c(&quot;&quot;, &quot;C&quot;), label_size = 12, ncol = 1,
  rel_heights = c(0.4, 0.6)
)</code></pre>
<p><img src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>To simplify the above plots without losing the basic interpretation,
we consider the different failure rate scenarios only for the original
enrollment rate scenario. We add a plot of the expected information fraction
for the scenarios above using the planned maximum information fraction from
the original design as the denominator.</p>
<pre class="r"><code>p1 &lt;- output |&gt;
  filter(Enrollment == &quot;Original&quot;) |&gt;
  ggplot(aes(x = time, y = event, lty = Scenario)) +
  geom_line() +
  geom_hline(yintercept = max(xx$analysis$event), linetype = &quot;dashed&quot;) +
  scale_x_continuous(breaks = seq(0, 48, 12)) +
  guides(lty = &quot;none&quot;, color = &quot;none&quot;) +
  ggsci::scale_color_futurama() +
  ylab(&quot;E(Events)&quot;) +
  xlab(&quot;Month&quot;)

p2 &lt;- output |&gt;
  filter(Enrollment == &quot;Original&quot;) |&gt;
  ggplot(aes(x = time, y = ahr, lty = Scenario)) +
  geom_line() +
  scale_x_continuous(breaks = seq(0, 48, 12)) +
  guides(lty = &quot;none&quot;, color = &quot;none&quot;) +
  ggsci::scale_color_futurama() +
  ylab(&quot;AHR&quot;) +
  xlab(&quot;Month&quot;)

p3 &lt;- output |&gt;
  filter(Enrollment == &quot;Original&quot;) |&gt;
  ggplot(aes(x = event, y = ahr, lty = Scenario)) +
  geom_line() +
  geom_vline(xintercept = max(xx$analysis$event), linetype = &quot;dashed&quot;) +
  ggsci::scale_color_futurama() +
  guides(lty = &quot;none&quot;) +
  ylab(&quot;AHR&quot;) +
  xlab(&quot;E(Events)&quot;) +
  theme(legend.position = &quot;right&quot;)

p4 &lt;- output |&gt;
  filter(Enrollment == &quot;Original&quot;) |&gt;
  mutate(IF = info0 / max(xx$analysis$info0)) |&gt;
  ggplot(aes(x = time, y = IF, lty = Scenario)) +
  geom_line() +
  scale_x_continuous(breaks = seq(0, 48, 12)) +
  ggsci::scale_color_futurama() +
  ylab(&quot;E(IF)&quot;) +
  xlab(&quot;Month&quot;) +
  geom_hline(yintercept = 1, linetype = &quot;dashed&quot;) +
  geom_hline(yintercept = xx$analysis$info_frac0[2], linetype = &quot;dashed&quot;) +
  geom_hline(yintercept = xx$analysis$info_frac0[1], linetype = &quot;dashed&quot;) +
  geom_abline(intercept = 0, slope = 1 / max(xx$analysis$time), linetype = &quot;dotted&quot;) +
  theme(legend.position = &quot;bottom&quot;)

legend &lt;- get_legend(p4)
p4a &lt;- p4 + theme(legend.position = &quot;none&quot;)
#  guides(lty = &quot;none&quot;, color = &quot;none&quot;)

# Now put all of these plots in a grid
top_row &lt;- cowplot::plot_grid(
  p1, p2, p3, p4a,
  labels = c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;),
  label_size = 12,
  ncol = 2,
  rel_heights = c(0.5, 0.5)
)
cowplot::plot_grid(
  top_row, legend,
  labels = c(&quot;&quot;, &quot;&quot;),
  label_size = 12,
  ncol = 1,
  rel_heights = c(0.9, 0.1)
)</code></pre>
<p><img src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="alternate-analysis-timing-and-alpha-spending-strategies" class="section level2">
<h2>Alternate analysis timing and <span class="math inline">\(\alpha\)</span>-spending strategies</h2>
<p>Timing of analyses and <span class="math inline">\(\alpha\)</span>-spending are done 3 ways:</p>
<ol style="list-style-type: decimal">
<li>Event-based timing and spending based on planned events above.</li>
<li>Time-based analyses and spending based on planned calendar time and
planned spending above.</li>
<li>Analyses at maximum of time when targeted events and targeted
calendar time are reached, spending as minimum of planned and actual.</li>
</ol>
<p>Another approach that might be considered is to analyze after, say,
every 8 months until the targeted events are reached with the first
interim analysis at 20 months; this has not been undertaken here as the
3rd approach above is presumed adequate to demonstrate the principle
we are suggesting.</p>
<p>We will focus on examples with the planned enrollment rates as these are
adequate for demonstrating the issues we are considering.
You can see in the plot above that different enrollment rates can impact
time to achieve targeted events which may be particularly challenging for
the calendar-based spending approach.</p>
<pre class="r"><code># Planned enrollment rates from design
enrollRates &lt;- xx$enroll_rate
# Planned information fraction at interim(s) and final
planned_IF &lt;- xx$analysis$event / max(xx$analysis$event)
# Spending time entered in timing for planned spending
upar_planned_spending &lt;- list(sf = gsDesign::sfLDOF, total_spend = alpha, timing = planned_IF)
# Information fraction (event-based) spending
max_info0 &lt;- max(xx$analysis$info0)
upar_IF_spending &lt;- list(
  sf = gsDesign::sfLDOF,
  total_spend = alpha,
  param = NULL,
  timing = NULL,
  max(max_info = xx$analysis$info0)
)
# Lower spending
lpar &lt;- rep(-Inf, 2)
# Events for event-based analysis timing
Events &lt;- xx$analysis$event
# Planned analysis times
analysisTimes &lt;- xx$analysis$time</code></pre>
<p>The following table displays the results.</p>
<pre class="r"><code>output &lt;- NULL
for (i in 1:nrow(scenarios)) {
  # Set failure rates
  # Failure rates from 1st scenario for design
  failRates &lt;- define_fail_rate(
    duration = c(scenarios$Delay[i], 100),
    fail_rate = log(2) / scenarios$ControlMedian[i],
    hr = c(scenarios$hr1[i], scenarios$hr2[i]),
    dropout_rate = dropoutRate
  )
  # Event-based timing and spending
  yIF &lt;- gs_power_ahr(
    enroll_rate = enrollRates,
    fail_rate = failRates,
    event = Events,
    analysis_time = NULL,
    upper = gs_spending_bound,
    upar = upar_IF_spending,
    lower = gs_b,
    lpar = rep(-Inf, length(Events))
  ) |&gt; to_integer()
  # Interim spending based on planned IF; timing based on calendar times
  yPlanned &lt;- gs_power_ahr(
    enroll_rate = enrollRates,
    fail_rate = failRates,
    event = NULL,
    analysis_time = analysisTimes,
    upper = gs_spending_bound,
    upar = upar_planned_spending,
    lower = gs_b,
    lpar = rep(-Inf, length(analysisTimes))
  )
  # Interim timing at max of planned time, events
  # Spending is min of planned and actual
  upar_both &lt;- list(
    sf = gsDesign::sfLDOF, total_spend = alpha, param = NULL,
    timing = pmin(planned_IF, Events / max(Events)), max_info = NULL
  )
  yBoth &lt;- gs_power_ahr(
    enroll_rate = enrollRates,
    fail_rate = failRates,
    event = Events,
    analysis_time = analysisTimes,
    upper = gs_spending_bound,
    upar = upar_both,
    lower = gs_b,
    lpar = rep(-Inf, length(Events))
  )

  output &lt;- rbind(
    output,
    # Event-based spending
    tibble(
      i = i, Scenario = scenarios$Scenario[i], &quot;Control Median&quot; = scenarios$ControlMedian[i],
      Delay = scenarios$Delay[i], HR1 = scenarios$hr1[i], HR2 = scenarios$hr2[i],
      Spending = &quot;IF&quot;, Analysis = yIF$analysis$analysis,
      N = yIF$analysis$n, Events = yIF$analysis$event, Time = yIF$analysis$time,
      &quot;Nominal p&quot; = pnorm(-yIF$bound$z),
      Power = yIF$bound$probability, AHR = yIF$analysis$ahr,
      `HR at bound` = yIF$bound$`~hr at bound`, IF = yIF$analysis$info_frac0,
      &quot;Spending time&quot; = yIF$analysis$info_frac0
    ),
    # Planned time, event-based spending
    tibble(
      i = i, Scenario = scenarios$Scenario[i], &quot;Control Median&quot; = scenarios$ControlMedian[i],
      Delay = scenarios$Delay[i], HR1 = scenarios$hr1[i], HR2 = scenarios$hr2[i],
      Spending = &quot;Planned&quot;, Analysis = yPlanned$analysis$analysis,
      N = yPlanned$analysis$n, Events = yPlanned$analysis$event, Time = yPlanned$analysis$time,
      &quot;Nominal p&quot; = pnorm(-yPlanned$bound$z),
      Power = yPlanned$bound$probability, AHR = yPlanned$analysis$ahr,
      `HR at bound` = yPlanned$bound$`~hr at bound`, IF = yPlanned$analysis$info_frac0,
      &quot;Spending time&quot; = upar_planned_spending$timing
    ),
    # Max of planned and actual
    tibble(
      i = i, Scenario = scenarios$Scenario[i], &quot;Control Median&quot; = scenarios$ControlMedian[i],
      Delay = scenarios$Delay[i], HR1 = scenarios$hr1[i], HR2 = scenarios$hr2[i],
      Spending = &quot;min(IF, Planned)&quot;, Analysis = yBoth$analysis$analysis,
      N = yBoth$analysis$n, Events = yBoth$analysis$event, Time = yBoth$analysis$time,
      &quot;Nominal p&quot; = pnorm(-yBoth$bound$z),
      Power = yBoth$bound$probability, AHR = yBoth$analysis$ahr,
      `HR at bound` = yBoth$bound$`~hr at bound`, IF = yBoth$analysis$info_frac0,
      &quot;Spending time&quot; = pmin(yBoth$analysis$info_frac0, planned_IF)
    )
  )
}</code></pre>
<p>The critical difference here is demonstrated when events accrue faster than
expected due to the treatment benefit emerging later.
Analysis timing is the same for both spending methods.
Using information fraction spending uses up 0.0194 of 0.025 <span class="math inline">\(\alpha\)</span> at the
interim analysis rather than the planned 0.012.
This means that the nominal p-value for the final test is 0.0162 as opposed to
0.0222 if the planned interim spending is used.
This also results in a power increase from 63.8% with information-based spending
to 68.4% when planned spending is used.
Being able to preserve the largest nominal bound for the final analysis is
in the general spirit of setting higher bounds at interim analysis if
an early stop is to be justified.</p>
<pre class="r"><code>output |&gt;
  select(-c(i, &quot;Control Median&quot;, Delay, HR1, HR2)) |&gt;
  mutate(
    Spending = factor(Spending, levels = c(&quot;IF&quot;, &quot;Planned&quot;, &quot;min(IF, Planned)&quot;)),
    Scenario = factor(Scenario)
  ) |&gt;
  datatable(
    options =
      list(
        filter = &quot;top&quot;,
        pageLength = 25,
        dom = &quot;Bfrtip&quot;,
        buttons = c(&quot;copy&quot;, &quot;csv&quot;, &quot;excel&quot;),
        scrollX = TRUE,
        columnDefs = list(
          list(width = &quot;35px&quot;, targets = c(0)), # Strategy column
          list(width = &quot;45px&quot;, targets = c(1)), # Scenario column
          list(width = &quot;45px&quot;, targets = c(7)) # Nominal p column
          # list(width = &#39;30px&#39;, targets = c(2, 3, 4)),  # Control Median, Delay, HR1 columns
          # list(width = &#39;25px&#39;, targets = c(5)),  # HR2 column
          # list(width = &#39;35px&#39;, targets = c(7, 8, 9)),  # Power, AHR, HR at bound columns
          # list(width = &#39;30px&#39;, targets = c(10, 11))  # IF and Spending time columns
        )
      ),
    filter = &quot;top&quot;,
    caption = &quot;Table 7: Design characteristics by spending strategy across scenarios&quot;
  ) |&gt;
  formatRound(columns = c(&quot;N&quot;, &quot;Events&quot;, &quot;Time&quot;), digits = 1) |&gt;
  # formatRound(columns = c(&quot;Nominal p&quot;), digits = 4) |&gt;
  formatRound(columns = c(&quot;Power&quot;, &quot;AHR&quot;, &quot;HR at bound&quot;, &quot;IF&quot;, &quot;Spending time&quot;, &quot;Nominal p&quot;), digits = 3) |&gt;
  htmlwidgets::onRender(&quot;
function(el, x) {
$(el).find(&#39;table&#39;).css(&#39;font-size&#39;, &#39;0.6em&#39;);
$(el).find(&#39;td&#39;).css(&#39;padding&#39;, &#39;1px 1px&#39;);
$(el).find(&#39;th&#39;).css(&#39;padding&#39;, &#39;1px 1px&#39;);
$(el).find(&#39;table&#39;).css(&#39;width&#39;, &#39;auto&#39;);
$(el).find(&#39;.dataTables_wrapper&#39;).css(&#39;width&#39;, &#39;auto&#39;);

// Adjust filter box widths to match column widths
var columnWidths = [35, 45, 30, 30, 30, 25, 45, 35, 35, 35, 30, 30];
$(el).find(&#39;input&#39;).each(function(i) {
$(this).css(&#39;width&#39;, columnWidths[i] + &#39;px&#39;);
});
}
&quot;)</code></pre>
<div class="datatables html-widget html-fill-item" id="htmlwidget-3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Events accrue faster&quot;,&quot;Events accrue slower&quot;,&quot;Null hypothesis&quot;,&quot;Original plan&quot;,&quot;Proportional hazards&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;IF&quot;,&quot;Planned&quot;,&quot;min(IF, Planned)&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"430\" data-max=\"430\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"172.471011054386\" data-max=\"348.728605513981\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"16.4910795512462\" data-max=\"47.5538463819621\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.005696149378715\" data-max=\"0.021055593364647\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.005696149378715\" data-max=\"0.960884753193793\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.661444233667869\" data-max=\"1\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.68020599329349\" data-max=\"0.803260958986228\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.630114047970428\" data-max=\"1\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.646944825992522\" data-max=\"1\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>Table 7: Design characteristics by spending strategy across scenarios<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45"],["Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis"],["IF","IF","IF","Planned","Planned","Planned","min(IF, Planned)","min(IF, Planned)","min(IF, Planned)","IF","IF","IF","Planned","Planned","Planned","min(IF, Planned)","min(IF, Planned)","min(IF, Planned)","IF","IF","IF","Planned","Planned","Planned","min(IF, Planned)","min(IF, Planned)","min(IF, Planned)","IF","IF","IF","Planned","Planned","Planned","min(IF, Planned)","min(IF, Planned)","min(IF, Planned)","IF","IF","IF","Planned","Planned","Planned","min(IF, Planned)","min(IF, Planned)","min(IF, Planned)"],[1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3],[430,430,430,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,430,430,430,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,430,430,430,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,430,430,430,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,430,430,430,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999,429.9999999999999],[209,273,318,209.0001235683513,273.0001512459255,317.9999999746474,209.0001235683513,273.0001512459255,317.9999999961426,209,273,318,244.7165648685869,303.1358225411852,341.8733961800298,244.7165648685869,303.1358225411852,341.8733961800298,209,273,318,172.4710110543857,229.5655501547853,273.713959575902,208.9999595950862,272.9999777487845,318.0000001790211,209,273,318,207.1606802826927,275.7017999380545,323.0569392608344,209.0000153557772,275.7017999380545,323.0569392608344,209,273,318,232.5668734579617,303.2094861170576,348.7286055139814,232.5668734579617,303.2094861170576,348.7286055139814],[19.94810196453181,27.85355444208754,36.01609370931672,19.948101820869,27.8535544775178,36.01609370932571,19.948101820869,27.8535544775178,36.01609371408107,16.49107955124621,23.34125950959786,30.57684725263098,19.948101820869,27.8535544775178,36.01609370932571,19.948101820869,27.8535544775178,36.01609370932571,24.73792770480398,35.86340389896794,47.55384638196212,19.948101820869,27.8535544775178,36.01609370932571,24.73792047259056,35.86337861955381,47.55384456656929,20.12382725430952,27.47460051415127,34.96893083506809,19.948101820869,27.8535544775178,36.01609370932571,20.12382849595318,27.8535544775178,36.01609370932571,17.95945047301143,24.01732013202692,30.10259487796049,19.948101820869,27.8535544775178,36.01609370932571,19.948101820869,27.8535544775178,36.01609370932571],[0.005696149378715106,0.01384371367471799,0.02009386137743124,0.005696149378715106,0.01384371391834291,0.02009387434156671,0.005696149378715106,0.01384371391834291,0.02009387433999811,0.005696149378715106,0.01384371367471799,0.02009386137743124,0.005696149378715106,0.014209452447034,0.02105559336464604,0.005696149378715106,0.014209452447034,0.02105559336464604,0.005696149378715106,0.01384371367471799,0.02009386137743124,0.005696149378715106,0.01372280532125742,0.01952392311939324,0.005696149378715106,0.0138437129428388,0.02009385915457486,0.005696149378715106,0.01384371367471799,0.02009386137743124,0.005696149378715106,0.01372365209049299,0.01990550449855876,0.005696149378715106,0.01377988421341086,0.01993016573774828,0.005696149378715106,0.01384371367471799,0.02009386137743124,0.005696149378715106,0.01385611668027949,0.0204008483223696,0.005696149378715106,0.01385611668027949,0.0204008483223696],[0.3454110801970635,0.7452979554761124,0.9008622504539483,0.3454113057091746,0.7452982157190021,0.9008622893176055,0.3454113057091746,0.7452982157190021,0.9008622893492954,0.01447521350742139,0.2529258202649258,0.5932365018678556,0.06951024488785137,0.4477680304291186,0.7378605565465477,0.06951024488785137,0.4477680304291186,0.7378605565465477,0.4071872566426931,0.836879721902521,0.9608847531937924,0.2040670161801754,0.6473229917644032,0.8695273854872485,0.4071869844878789,0.8368794779401194,0.9608847386112729,0.5188979855508536,0.7817801871584917,0.8857463573346189,0.5144009861392281,0.7855210112783185,0.8903343358353196,0.5188980230033714,0.7857933837394857,0.8903632362813937,0.005696149378715106,0.01555936464720187,0.02500000000003677,0.005696149378715106,0.01555936464720391,0.02500000000003884,0.005696149378715106,0.01555936464720391,0.02500000000003884],[0.744959561603879,0.7081095001524125,0.6917019002487268,0.7449595626841687,0.7081095000511574,0.6917019002487143,0.7449595626841687,0.7081095000511574,0.6917019002420645,0.9577210178321336,0.8277370305717113,0.7707487070345641,0.8773939319182686,0.7872787438303546,0.7478053225600556,0.8773939319182686,0.7872787438303546,0.7478053225600556,0.7282555491095256,0.6818699243200391,0.6614442336678696,0.7728699805746998,0.7101687326832928,0.6814878251809624,0.728255598490727,0.6818699879347612,0.661444235844707,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,1,1,1,1,1,1,1,1,1],[0.7046409248427792,0.7660526980306712,0.7944382214976837,0.7046409977632984,0.7660527552226076,0.7944382452526227,0.7046409977632984,0.7660527552226076,0.7944382452559263,0.7046409248427792,0.7660526980306712,0.7944382214976837,0.7236021138359813,0.7774506182642511,0.8026455778323422,0.7236021138359813,0.7774506182642511,0.8026455778323422,0.7046409248427792,0.7660526980306712,0.7944382214976837,0.6802059932934907,0.7474575422413546,0.7792109535442467,0.7046409009989001,0.766052687790479,0.794438217474823,0.7046409248427792,0.7660526980306712,0.7944382214976837,0.7035491291385138,0.7667411789976325,0.7955315638437813,0.7046409339045787,0.7668889798628041,0.7955768102371555,0.7046409248427792,0.7660526980306712,0.7944382214976837,0.7175903027034586,0.7765924913317483,0.8032609589862275,0.7175903027034586,0.7765924913317483,0.8032609589862275],[0.6572327044025157,0.8584905660377359,1,0.657233093034635,0.8584910417222972,1,0.6572330929902093,0.8584910416642675,1,0.6572327044025157,0.8584905660377359,1,0.7158104947707592,0.886690295086765,1,0.7158104947707592,0.886690295086765,1,0.6572327044025157,0.8584905660377359,1,0.6301140479704281,0.838706036442127,1,0.657232576973043,0.8584904955820649,1,0.6572327044025157,0.8584905660377359,1,0.6412512938328568,0.8534155018272318,1,0.646944825992522,0.8534155018272318,1,0.6572327044025157,0.8584905660377359,1,0.666899330254792,0.8694712200915253,1,0.666899330254792,0.8694712200915253,1],[0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.657232576973043,0.8584904955820649,1,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.646944825992522,0.8534155018272318,1,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Scenario<\/th>\n      <th>Spending<\/th>\n      <th>Analysis<\/th>\n      <th>N<\/th>\n      <th>Events<\/th>\n      <th>Time<\/th>\n      <th>Nominal p<\/th>\n      <th>Power<\/th>\n      <th>AHR<\/th>\n      <th>HR at bound<\/th>\n      <th>IF<\/th>\n      <th>Spending time<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"filter":"top","pageLength":25,"dom":"Bfrtip","buttons":["copy","csv","excel"],"scrollX":true,"columnDefs":[{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"width":"35px","targets":0},{"width":"45px","targets":1},{"width":"45px","targets":7},{"className":"dt-right","targets":[3,4,5,6,7,8,9,10,11,12]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Scenario","targets":1},{"name":"Spending","targets":2},{"name":"Analysis","targets":3},{"name":"N","targets":4},{"name":"Events","targets":5},{"name":"Time","targets":6},{"name":"Nominal p","targets":7},{"name":"Power","targets":8},{"name":"AHR","targets":9},{"name":"HR at bound","targets":10},{"name":"IF","targets":11},{"name":"Spending time","targets":12}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render"],"jsHooks":{"render":[{"code":"\nfunction(el, x) {\n$(el).find('table').css('font-size', '0.6em');\n$(el).find('td').css('padding', '1px 1px');\n$(el).find('th').css('padding', '1px 1px');\n$(el).find('table').css('width', 'auto');\n$(el).find('.dataTables_wrapper').css('width', 'auto');\n\n// Adjust filter box widths to match column widths\nvar columnWidths = [35, 45, 30, 30, 30, 25, 45, 35, 35, 35, 30, 30];\n$(el).find('input').each(function(i) {\n$(this).css('width', columnWidths[i] + 'px');\n});\n}\n","data":null}]}}</script>
<p>Now we summarize design characteristics by spending strategy across scenarios.
We see that using the minimum of planned and actual spending retains the
highest power across scenarios (A).
If events accrue more slowly than planned,
the minimum of planned and actual spending adapts to longer duration (B),
more events (C) and a stronger effect size (AHR) than using the planned
calendar timing and spending.
Using event-based (IF) spending results in lower power if events accrue faster
than planned due to a lesser effect size (higher AHR) and fewer events than
timing analyses at the maximum of planned and actual time.
Under proportional hazards and the original delayed effect scenario,
all strategies have similar power.
The final analysis nominal p-value is highest for the minimum of planned and
actual spending, regardless of scenario (E).</p>
<pre class="r"><code># Power plot
p1 &lt;- output |&gt;
  filter(Analysis == 3) |&gt;
  ggplot(aes(x = Scenario, y = Power, fill = Spending)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylab(&quot;Power&quot;) +
  xlab(&quot;Scenario&quot;)

# Events plot
p2 &lt;- output |&gt;
  filter(Analysis == 3) |&gt;
  ggplot(aes(x = Scenario, y = Events, fill = Spending)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylab(&quot;Events&quot;) +
  xlab(&quot;Scenario&quot;)

# Z-score plot
p3 &lt;- output |&gt;
  filter(Analysis == 3) |&gt;
  ggplot(aes(x = Scenario, y = `HR at bound`, fill = Spending)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylab(&quot;HR at bound&quot;) +
  xlab(&quot;Scenario&quot;)

# Display plots with increased height
cowplot::plot_grid(p1, p2, p3, ncol = 1, labels = c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;), rel_heights = c(1, 1, 1))</code></pre>
<p><img src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/figure-html/unnamed-chunk-25-1.png" width="100%" /></p>
</div>
<div id="simulation-to-verify-operating-characteristics" class="section level2">
<h2>Simulation to verify operating characteristics</h2>
<p>We focus on the case where events accrue faster than planned to ensure that
adapting spending is not impacting Type I error as well as to confirm power
with the different strategies.
We write a function to simulate a trial, including cutting off for analyses
with different strategies.</p>
<div id="simulate-a-single-trial-and-perform-tests" class="section level3">
<h3>Simulate a single trial and perform tests</h3>
<pre class="r"><code># Convert failure rates to simulation format
# Scenario 1
# rates &lt;- to_sim_pw_surv(xx$fail_rate)
# Null hypothesis
rates &lt;- to_sim_pw_surv(xx$fail_rate |&gt; mutate(hr = 1))

# Simulate a trial
simulate_a_trial &lt;- function(
    n, enroll_rate, fail_rate, dropout_rate, target_events, target_time,
    block = c(
      &quot;control&quot;, &quot;control&quot;,
      &quot;experimental&quot;, &quot;experimental&quot;
    )) {
  cut_date_events &lt;- rep(0, length(target_events))
  cut_date_both &lt;- rep(0, length(target_events))
  output &lt;- NULL
  dat &lt;- sim_pw_surv(
    n = n, stratum = data.frame(stratum = &quot;All&quot;, p = 1),
    enroll_rate = enroll_rate, fail_rate = fail_rate,
    dropout_rate = dropout_rate, block = block
  )

  for (k in seq_along(target_events)) {
    # Time to targeted event count
    cut_date_events[k] &lt;- get_cut_date_by_event(dat, target_events[k])
    # Time to max of targeted event count, targeted time
    cut_date_both[k] &lt;- max(cut_date_events[k], target_time[k])
  }
  # get unique analysis time cutoffs
  cut_times &lt;- unique(c(cut_date_events, target_time))

  # Do analyses at targeted times
  for (k in seq_along(cut_times)) {
    # Cut data
    dat_cut &lt;- cut_data_by_date(dat, cut_times[k])
    # Get counting process dataset to be used for both tests of interest
    counting_data &lt;- dat_cut |&gt; counting_process(arm = &quot;experimental&quot;)
    # Sum total events across times at which events are observed
    Events &lt;- sum(dat_cut$event)
    # sum(counting_data$event_total) #
    # Compute logrank test
    test &lt;- counting_data |&gt;
      wlr(weight = fh(rho = 0, gamma = 0), return_variance = TRUE) |&gt;
      as.data.frame() |&gt;
      mutate(test = &quot;lr&quot;, Time = cut_times[k], Events = Events) |&gt;
      select(-c(method, parameter, estimate, se))
    # Compute Magirr-Burman test
    test_mb &lt;- counting_data |&gt;
      wlr(weight = mb(delay = Inf, w_max = 2)) |&gt;
      # info conversion is a GUESS to match planned design; needs checking
      as.data.frame() |&gt;
      mutate(test = &quot;mwlr&quot;, Time = cut_times[k], Events = Events) |&gt;
      select(-c(method, parameter, estimate, se))
    # Add a record for each of the above tests
    output &lt;- rbind(output, test, test_mb)
  }
  # Accumulate analyses for each cutting method
  output &lt;-
    bind_rows(
      tibble(Cut = &quot;Events&quot;, Time = cut_date_events),
      tibble(Cut = &quot;Time&quot;, Time = target_time),
      tibble(Cut = &quot;Both&quot;, Time = cut_date_both)
    ) |&gt; left_join(output, by = &quot;Time&quot;, relationship = &quot;many-to-many&quot;)
  # Cutoff at max of planned time, events, spending based on min of planned, actual events
  lrboth &lt;- output |&gt; filter(Cut == &quot;Both&quot; &amp; test == &quot;lr&quot;)
  lrboth$Analysis &lt;- seq_along(lrboth$Events)
  lrboth$sTime &lt;- pmin(
    xx$analysis$event / max(xx$analysis$event),
    Events / max(xx$analysis$event)
  )
  lrboth$sTime[3] &lt;- 1 # Full spend at final analysis
  lrboth$spend &lt;- diff(c(0, sfLDOF(alpha = alpha, t = lrboth$sTime)$spend))
  lrboth$Bound &lt;- gsBound1(
    theta = 0, I = lrboth$Events, a = rep(-20, 3),
    probhi = lrboth$spend, tol = 1e-06, r = 18
  )$b
  lrboth$IF &lt;- lrboth$Events / max(xx$analysis$event)
  lrboth$&quot;Reject H0&quot; &lt;- ifelse(lrboth$z &gt;= lrboth$Bound, TRUE, FALSE)
  lrboth$Spending &lt;- &quot;min(planned, actual)&quot;

  # Cutoff at max of planned time, events, spending based on events
  lrbothe &lt;- lrboth
  lrbothe$Analysis &lt;- seq_along(lrbothe$Events)
  lrbothe$sTime &lt;- lrbothe$Events / max(xx$analysis$event)
  # Final total spending time should be at least 1
  lrbothe$sTime[3] &lt;- max(1, lrbothe$sTime[3])
  lrbothe$spend &lt;- diff(c(0, sfLDOF(alpha = alpha, t = lrbothe$sTime)$spend))
  # May be instances where final event count is reached by IA 2
  # when planned time of IA2 is reached
  if (lrbothe$sTime[2] &lt; 1) {
    lrbothe$Bound &lt;- gsBound1(
      theta = 0, I = lrbothe$Events, a = rep(-20, 3),
      probhi = lrbothe$spend, tol = 1e-06, r = 18
    )$b
  } else {
    lrbothe$Bound &lt;- c(
      gsBound1(
        theta = 0, I = lrbothe$Events[1:2], a = rep(-20, 2),
        probhi = lrbothe$spend[1:2], tol = 1e-06, r = 18
      )$b,
      Inf
    )
  }
  lrbothe$IF &lt;- lrbothe$Events / max(xx$analysis$event)
  lrbothe$&quot;Reject H0&quot; &lt;- ifelse(lrbothe$z &gt;= lrbothe$Bound, TRUE, FALSE)
  lrbothe$Spending &lt;- &quot;Events&quot;

  # mwlr with min(Planned, Actual) spending
  mwlrboth &lt;- output |&gt; filter(Cut == &quot;Both&quot; &amp; test == &quot;mwlr&quot;)
  mwlrboth$Analysis &lt;- seq_along(mwlrboth$Events)
  mwlrboth$sTime &lt;- pmin(
    mwlrboth$info0 / max(mb_design$analysis$info0),
    mb_design$analysis$info_frac0
  )
  mwlrboth$sTime[3] &lt;- max(1, mwlrboth$sTime[3]) # Full spend at final analysis
  mwlrboth$spend &lt;- diff(c(0, sfLDOF(alpha = alpha, t = mwlrboth$sTime)$spend))
  mwlrboth$Bound &lt;- gsBound1(
    theta = 0, I = mwlrboth$info0, a = rep(-20, 3),
    probhi = mwlrboth$spend, tol = 1e-06, r = 18
  )$b
  mwlrboth$IF &lt;- mwlrboth$info0 / max(mb_design$analysis$info0)
  mwlrboth$&quot;Reject H0&quot; &lt;- ifelse(mwlrboth$z &gt;= mwlrboth$Bound, TRUE, FALSE)
  mwlrboth$Spending &lt;- &quot;min(planned, actual)&quot;

  # Cut at max of planned time, events, spending based on info0, mwlr
  mwlrbothe &lt;- mwlrboth
  mwlrbothe$Analysis &lt;- seq_along(mwlrbothe$info0)
  mwlrbothe$sTime &lt;- mwlrbothe$info0 / max(mb_design$analysis$info0)
  mwlrbothe$sTime[3] &lt;- max(1, mwlrbothe$sTime[3]) # Full spend at final analysis
  mwlrbothe$spend &lt;- diff(c(0, sfLDOF(alpha = alpha, t = mwlrbothe$sTime)$spend))
  # May be instances where final info0 is reached by IA 2
  # when planned time of IA2 is reached
  if (mwlrbothe$sTime[2] &lt; 1) {
    mwlrbothe$Bound &lt;- gsBound1(
      theta = 0, I = mwlrbothe$info0, a = rep(-20, 3),
      probhi = mwlrbothe$spend, tol = 1e-06, r = 18
    )$b
  } else {
    mwlrbothe$Bound &lt;- c(
      gsBound1(
        theta = 0, I = mwlrbothe$info0[1:2], a = rep(-20, 2),
        probhi = mwlrbothe$spend[1:2], tol = 1e-06, r = 18
      )$b,
      Inf
    )
  }
  mwlrbothe$IF &lt;- mwlrbothe$info0 / max(mb_design$analysis$info0)
  mwlrbothe$&quot;Reject H0&quot; &lt;- ifelse(mwlrbothe$z &gt;= mwlrbothe$Bound, TRUE, FALSE)
  mwlrbothe$Spending &lt;- &quot;IF&quot;

  # Cut at targeted events, lr
  lrevents &lt;- output |&gt; filter(Cut == &quot;Events&quot; &amp; test == &quot;lr&quot;)
  lrevents$Analysis &lt;- seq_along(lrevents$Events)
  lrevents$sTime &lt;- xx$analysis$info_frac0
  lrevents$spend &lt;- diff(c(0, xx$bound$probability0))
  lrevents$Bound &lt;- xx$bound$z
  lrevents$IF &lt;- xx$analysis$info_frac0
  lrevents$&quot;Reject H0&quot; &lt;- ifelse(lrevents$z &gt;= lrevents$Bound, TRUE, FALSE)
  lrevents$Spending &lt;- &quot;Events&quot;

  # Cut at targeted events, mwlr
  mwlrevents &lt;- output |&gt; filter(Cut == &quot;Events&quot; &amp; test == &quot;mwlr&quot;)
  mwlrevents$Analysis &lt;- seq_along(mwlrevents$Events)
  mwlrevents$sTime &lt;- mwlrevents$info0 / max(mb_design$analysis$info0)
  mwlrevents$sTime[3] &lt;- max(1, mwlrevents$sTime[3])
  mwlrevents$spend &lt;- diff(c(0, sfLDOF(alpha = alpha, t = mwlrevents$sTime)$spend))
  mwlrevents$Bound &lt;- gsBound1(
    theta = 0, I = mwlrevents$info0, a = rep(-20, 3),
    probhi = mwlrevents$spend, tol = 1e-06, r = 18
  )$b
  mwlrevents$IF &lt;- mwlrevents$info0 / max(mb_design$analysis$info0)
  mwlrevents$&quot;Reject H0&quot; &lt;- ifelse(mwlrevents$z &gt;= mwlrevents$Bound, TRUE, FALSE)
  mwlrevents$Spending &lt;- &quot;IF&quot;

  # Cut at targeted time, lr
  lrtime &lt;- output |&gt; filter(Cut == &quot;Time&quot; &amp; test == &quot;lr&quot;)
  lrtime$Analysis &lt;- seq_along(lrtime$Events)
  lrtime$sTime &lt;- xx$analysis$time / max(xx$analysis$time)
  lrtime$spend &lt;- diff(c(0, sfLDOF(alpha = alpha, t = lrtime$sTime)$spend))
  lrtime$Bound &lt;- gsBound1(
    theta = 0, I = lrtime$Events, a = rep(-20, 3),
    probhi = lrtime$spend, tol = 1e-06, r = 18
  )$b
  lrtime$IF &lt;- lrtime$info0 / max(xx$analysis$info0)
  lrtime$&quot;Reject H0&quot; &lt;- ifelse(lrtime$z &gt;= lrtime$Bound, TRUE, FALSE)
  lrtime$Spending &lt;- &quot;Time&quot;

  # Cut at targeted time, mwlr
  mwlrtime &lt;- output |&gt; filter(Cut == &quot;Time&quot; &amp; test == &quot;mwlr&quot;)
  mwlrtime$Analysis &lt;- seq_along(mwlrtime$Events)
  mwlrtime$sTime &lt;- lrtime$sTime
  mwlrtime$spend &lt;- lrtime$spend
  mwlrtime$Bound &lt;- gsBound1(
    theta = 0, I = mwlrtime$info0, a = rep(-20, 3),
    probhi = mwlrtime$spend, tol = 1e-06, r = 18
  )$b
  mwlrtime$IF &lt;- mwlrtime$info0 / max(mb_design$analysis$info0)
  mwlrtime$&quot;Reject H0&quot; &lt;- ifelse(mwlrtime$z &gt;= mwlrtime$Bound, TRUE, FALSE)
  mwlrtime$Spending &lt;- &quot;Time&quot;

  # Combine all results
  bind_rows(
    lrevents, mwlrevents, lrtime, mwlrtime,
    lrboth, mwlrboth, lrbothe, mwlrbothe
  )
}</code></pre>
<p>For each trial simulated there are 2 x 3 x 4 = 24 analyses performed,
one for each of the 4 cutting-spending strategies (time, events, max of time
and event with either event-based or minimum of planned and actual information
fraction spending), 2 tests (logrank and Magirr-Burman) as well as 3 analyses
(2 interims and final).</p>
<pre class="r"><code>output &lt;- simulate_a_trial(
  n = max(xx$analysis$n),
  enroll_rate = xx$enroll_rate,
  fail_rate = rates$fail_rate,
  dropout_rate = rates$dropout_rate,
  target_events = xx$analysis$event,
  target_time = xx$analysis$time
)
output |&gt;
  transmute(
    Cut = factor(Cut, levels = c(&quot;Events&quot;, &quot;Time&quot;, &quot;Both&quot;)),
    Spending = factor(Spending, levels = c(&quot;Events&quot;, &quot;Time&quot;, &quot;IF&quot;, &quot;min(planned, actual)&quot;)),
    test = factor(test, levels = c(&quot;lr&quot;, &quot;mwlr&quot;)),
    Analysis = Analysis,
    Time = Time,
    Events = Events,
    IF = IF,
    sTime = sTime,
    spend = spend,
    Bound = Bound,
    z = z,
    &quot;Reject H0&quot; = factor(`Reject H0`),
    info0 = info0,
    info = info
  ) |&gt;
  datatable(
    options = list(
      filter = &quot;top&quot;, pageLength = 25, dom = &quot;Bfrtip&quot;,
      buttons = c(&quot;copy&quot;, &quot;csv&quot;, &quot;excel&quot;), scrollX = TRUE
    ),
    filter = &quot;top&quot;,
    caption = paste(&quot;Table 8: Example output from a single trial simulation&quot;)
  ) |&gt;
  formatRound(columns = c(&quot;Time&quot;, &quot;info0&quot;, &quot;info&quot;), digits = 1) |&gt;
  formatRound(columns = c(&quot;IF&quot;, &quot;sTime&quot;, &quot;Bound&quot;, &quot;z&quot;), digits = 2) |&gt;
  formatRound(columns = c(&quot;spend&quot;), digits = 3) |&gt;
  htmlwidgets::onRender(&quot;
function(el, x) {
$(el).find(&#39;table&#39;).css(&#39;font-size&#39;, &#39;0.6em&#39;);
$(el).find(&#39;td&#39;).css(&#39;padding&#39;, &#39;1px 1px&#39;);
$(el).find(&#39;th&#39;).css(&#39;padding&#39;, &#39;1px 1px&#39;);
$(el).find(&#39;table&#39;).css(&#39;width&#39;, &#39;auto&#39;);
$(el).find(&#39;.dataTables_wrapper&#39;).css(&#39;width&#39;, &#39;auto&#39;);
}
&quot;)</code></pre>
<div class="datatables html-widget html-fill-item" id="htmlwidget-4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Events&quot;,&quot;Time&quot;,&quot;Both&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Events&quot;,&quot;Time&quot;,&quot;IF&quot;,&quot;min(planned, actual)&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;lr&quot;,&quot;mwlr&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"17.6685172705949\" data-max=\"36.0160937093257\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"209\" data-max=\"352\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.492353868756469\" data-max=\"1.12476769208553\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.492353868756469\" data-max=\"1.12476769208553\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.001401506675781\" data-max=\"0.014490298668159\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.99095144989713\" data-max=\"2.98855359485733\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.257207415447009\" data-max=\"1.15151262480301\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;FALSE&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"52.25\" data-max=\"242.366436945766\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"52.1052631578947\" data-max=\"242.294389779799\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>Table 8: Example output from a single trial simulation<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["Events","Events","Events","Events","Events","Events","Time","Time","Time","Time","Time","Time","Both","Both","Both","Both","Both","Both","Both","Both","Both","Both","Both","Both"],["Events","Events","Events","IF","IF","IF","Time","Time","Time","Time","Time","Time","min(planned, actual)","min(planned, actual)","min(planned, actual)","min(planned, actual)","min(planned, actual)","min(planned, actual)","Events","Events","Events","IF","IF","IF"],["lr","lr","lr","mwlr","mwlr","mwlr","lr","lr","lr","mwlr","mwlr","mwlr","lr","lr","lr","mwlr","mwlr","mwlr","lr","lr","lr","mwlr","mwlr","mwlr"],[1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3],[17.6685172705949,23.52122185410808,30.83219428810557,17.6685172705949,23.52122185410808,30.83219428810557,19.948101820869,27.8535544775178,36.01609370932571,19.948101820869,27.8535544775178,36.01609370932571,19.948101820869,27.8535544775178,36.01609370932571,19.948101820869,27.8535544775178,36.01609370932571,19.948101820869,27.8535544775178,36.01609370932571,19.948101820869,27.8535544775178,36.01609370932571],[209,273,318,209,273,318,247,305,352,247,305,352,247,305,352,247,305,352,247,305,352,247,305,352],[0.6572327044025157,0.8584905660377359,1,0.4923538687564697,0.7674281471304419,0.976262946130168,0.7767295597484277,0.9591194968553459,1.10062893081761,0.6507219534957656,0.9159328930858027,1.124767692085529,0.7767295597484277,0.9591194968553459,1.106918238993711,0.6507219534957656,0.9159328930858027,1.124767692085529,0.7767295597484277,0.9591194968553459,1.106918238993711,0.6507219534957656,0.9159328930858027,1.124767692085529],[0.6572327044025157,0.8584905660377359,1,0.4923538687564697,0.7674281471304419,1,0.5538663349185977,0.773364116117502,1,0.5538663349185977,0.773364116117502,1,0.6572327044025157,0.8584905660377359,1,0.4928620948827703,0.7846020196932224,1,0.7767295597484277,0.9591194968553459,1.106918238993711,0.6507219534957656,0.9159328930858027,1.124767692085529],[0.005696149378715106,0.009863215268486762,0.009440635352834906,0.001401506675781095,0.00910819465606072,0.01449029866815832,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.005696149378715099,0.009863215268450132,0.009440635352834903,0.001409526194155353,0.009982593014110863,0.01360788079173392,0.01098341171974848,0.01111501146910898,0.00290157681114267,0.005459786158241497,0.01372060243728424,0.005819611404474401],[2.530429466721196,2.201686975872088,2.051814199952669,2.988553594857334,2.324170901160113,2.013229438154713,2.79468023670819,2.312947168509286,1.990951449897129,2.79468023670819,2.327099063808137,2.009699184371005,2.530429466721196,2.190816612228652,2.044011649570333,2.986809594948912,2.287075049701266,2.012370280949715,2.290941048709514,2.077142886128908,2.232256879051871,2.545262160130577,2.108139355654476,2.159025778305685],[1.014337178054909,0.9000749350310276,1.106851513073666,1.073310924809027,0.9201993030893361,1.151512624803014,0.3845167942912318,0.8429144011502904,1.075780014908688,0.2572074154470095,0.8317124066586657,1.097804882180627,0.3845167942912318,0.8429144011502904,1.075780014908688,0.2572074154470095,0.8317124066586657,1.097804882180627,0.3845167942912318,0.8429144011502904,1.075780014908688,0.2572074154470095,0.8317124066586657,1.097804882180627],["FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE"],[52.25,68.25,79.5,106.0930659074219,165.3664369457659,210.3664369457659,61.75,76.25,87.5,140.2184312555488,197.3664369457659,242.3664369457659,61.75,76.25,87.5,140.2184312555488,197.3664369457659,242.3664369457659,61.75,76.25,87.5,140.2184312555488,197.3664369457659,242.3664369457659],[52.10526315789474,68.17582417582418,79.38679245283019,105.7635804774324,165.2042560177591,210.048459966791,61.74898785425101,76.20983606557378,87.4542857142857,140.1599417750195,197.31524106988,242.2943897797989,61.74898785425101,76.20983606557378,87.4542857142857,140.1599417750195,197.31524106988,242.2943897797989,61.74898785425101,76.20983606557378,87.4542857142857,140.1599417750195,197.31524106988,242.2943897797989]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Cut<\/th>\n      <th>Spending<\/th>\n      <th>test<\/th>\n      <th>Analysis<\/th>\n      <th>Time<\/th>\n      <th>Events<\/th>\n      <th>IF<\/th>\n      <th>sTime<\/th>\n      <th>spend<\/th>\n      <th>Bound<\/th>\n      <th>z<\/th>\n      <th>Reject H0<\/th>\n      <th>info0<\/th>\n      <th>info<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"filter":"top","pageLength":25,"dom":"Bfrtip","buttons":["copy","csv","excel"],"scrollX":true,"columnDefs":[{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":14,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[4,5,6,7,8,9,10,11,13,14]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Cut","targets":1},{"name":"Spending","targets":2},{"name":"test","targets":3},{"name":"Analysis","targets":4},{"name":"Time","targets":5},{"name":"Events","targets":6},{"name":"IF","targets":7},{"name":"sTime","targets":8},{"name":"spend","targets":9},{"name":"Bound","targets":10},{"name":"z","targets":11},{"name":"Reject H0","targets":12},{"name":"info0","targets":13},{"name":"info","targets":14}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render"],"jsHooks":{"render":[{"code":"\nfunction(el, x) {\n$(el).find('table').css('font-size', '0.6em');\n$(el).find('td').css('padding', '1px 1px');\n$(el).find('th').css('padding', '1px 1px');\n$(el).find('table').css('width', 'auto');\n$(el).find('.dataTables_wrapper').css('width', 'auto');\n}\n","data":null}]}}</script>
</div>
<div id="simulate-multiple-trials-in-parallel" class="section level3">
<h3>Simulate multiple trials in parallel</h3>
<p>Now we simulate all trials with a parallel computing strategy.
We evaluate the different cutting strategies and compare spending-time-based
and information-fraction-based testing for both the logrank and Magirr-Burman
tests evaluated above.</p>
<p>Set up parallel computing.</p>
<pre class="r"><code># Set a seed for reproducibility and use `.options.future = list(seed = TRUE)`
# for parallel-safe RNG. Use foreach + %dofuture% to perform parallel computation.
set.seed(42)</code></pre>
<pre class="r"><code>if (run_simulations) {
  # Start timing
  tic(&quot;Total simulation time&quot;)

  # Initialize result
  # result &lt;- data.frame() # For sequential
  result &lt;- list(1, 2, 3, 4, 5) # For parallel
  # Run simulation for all scenarios
  for (scen in 1:5) {
    # Run for first 5 scenarios
    failRates &lt;- define_fail_rate(
      duration = c(scenarios$Delay[scen], 100),
      fail_rate = log(2) / scenarios$ControlMedian[scen],
      hr = c(scenarios$hr1[scen], scenarios$hr2[scen]),
      dropout_rate = dropoutRate
    )
    rates &lt;- to_sim_pw_surv(failRates)

    # Run simulations in parallel
    result[[scen]] &lt;- foreach(
      i = 1:nsim,
      .combine = &quot;rbind&quot;,
      .options.future = list(seed = TRUE)
    ) %dofuture% {
      # for (i in 1:nsim) {
      trial_result &lt;- simulate_a_trial(
        n = max(xx$analysis$n),
        enroll_rate = xx$enroll_rate,
        fail_rate = rates$fail_rate,
        dropout_rate = rates$dropout_rate,
        target_events = xx$analysis$event,
        target_time = xx$analysis$time,
        block = c(&quot;control&quot;, &quot;control&quot;, &quot;experimental&quot;, &quot;experimental&quot;)
      )
      trial_result$Sim &lt;- i
      trial_result$Scenario &lt;- scenarios$Scenario[scen]
      # Within each test, Cut, Spending combination, compute a variable &#39;FirstReject&#39;
      # which is TRUE for the first analysis that &#39;Reject H0&#39; is TRUE and otherwise FALSE
      trial_result |&gt;
        dplyr::group_by(Sim, test, Cut, Spending) |&gt;
        dplyr::mutate(
          FirstReject = ifelse(`Reject H0` &amp; !duplicated(`Reject H0`), TRUE, FALSE)
        ) |&gt;
        dplyr::ungroup()
    }
    save(result, file = &quot;DelayedEffectSimulation.RData&quot;)
    toc()
  }
} else {
  load(&quot;DelayedEffectSimulation.RData&quot;)
}</code></pre>
<pre><code>#&gt; Total simulation time: 792.51 sec elapsed</code></pre>
<p>We wish to mimic asymptotic approximations with appropriate simulations
for each scenario and analysis for: Spending, Events, Time, Power,
AHR (later!), IF, and Spending time.</p>
<pre class="r"><code># Basic summary
result_summary &lt;- NULL
for (i in 1:5) {
  result_summary &lt;- rbind(
    result_summary,
    result[[i]] |&gt;
      group_by(test, Cut, Spending, Analysis) |&gt;
      summarize(
        &quot;E(Spend)&quot; = mean(spend),
        &quot;E(Events)&quot; = mean(Events),
        &quot;E(Time)&quot; = mean(Time),
        Power = mean(FirstReject),
        &quot;E(IF)&quot; = mean(IF),
        &quot;E(sTime)&quot; = mean(sTime)
      ) |&gt;
        ungroup() |&gt;
        group_by(test, Cut, Spending) |&gt;
        arrange(Analysis, .by_group = TRUE) |&gt;
        mutate(Power = cumsum(Power), Scenario = scenarios$Scenario[i])
  )
}

# Display results
result_summary |&gt;
  transmute(
    Scenario = factor(Scenario),
    Test = factor(test),
    Cut = factor(Cut),
    Spending = factor(Spending),
    Analysis = factor(Analysis),
    &quot;E(Spend)&quot; = `E(Spend)`,
    &quot;E(Events)&quot; = `E(Events)`,
    &quot;E(Time)&quot; = `E(Time)`,
    Power = Power,
    &quot;E(IF)&quot; = `E(IF)`,
    &quot;E(sTime)&quot; = `E(sTime)`
  ) |&gt;
  datatable(
    options = list(
      filter = &quot;top&quot;, pageLength = 25, dom = &quot;Bfrtip&quot;,
      buttons = c(&quot;copy&quot;, &quot;csv&quot;, &quot;excel&quot;), scrollX = TRUE
    ),
    filter = &quot;top&quot;,
    caption = paste(&quot;Table 9: Simulation results summary (based on&quot;, nsim, &quot;simulations per scenario)&quot;)
  ) |&gt;
  formatRound(columns = c(&quot;E(Time)&quot;, &quot;E(Events)&quot;), digits = 1) |&gt;
  formatRound(columns = c(&quot;E(Spend)&quot;, &quot;Power&quot;), digits = 4) |&gt;
  formatRound(columns = c(&quot;E(IF)&quot;), digits = 3) |&gt;
  formatRound(columns = c(&quot;E(sTime)&quot;), digits = 2) |&gt;
  htmlwidgets::onRender(&quot;
function(el, x) {
$(el).find(&#39;table&#39;).css(&#39;font-size&#39;, &#39;0.6em&#39;);
$(el).find(&#39;td&#39;).css(&#39;padding&#39;, &#39;1px 1px&#39;);
$(el).find(&#39;th&#39;).css(&#39;padding&#39;, &#39;1px 1px&#39;);
$(el).find(&#39;table&#39;).css(&#39;width&#39;, &#39;auto&#39;);
$(el).find(&#39;.dataTables_wrapper&#39;).css(&#39;width&#39;, &#39;auto&#39;);
}
&quot;)</code></pre>
<div class="datatables html-widget html-fill-item" id="htmlwidget-5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Events accrue faster&quot;,&quot;Events accrue slower&quot;,&quot;Null hypothesis&quot;,&quot;Original plan&quot;,&quot;Proportional hazards&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;lr&quot;,&quot;mwlr&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Both&quot;,&quot;Events&quot;,&quot;Time&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Events&quot;,&quot;min(planned, actual)&quot;,&quot;Time&quot;,&quot;IF&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.00121988292226\" data-max=\"0.015139454035516\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"172.31049\" data-max=\"348.62266\" data-scale=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"16.5081274218413\" data-max=\"47.4731349776527\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.00147\" data-max=\"0.97769\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.345346893935589\" data-max=\"1.11902489782962\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.480268554965801\" data-max=\"1.1190372407853\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>Table 9: Simulation results summary (based on 1e+05 simulations per scenario)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120"],["lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr"],["Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Original plan","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue faster","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Events accrue slower","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Proportional hazards","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis","Null hypothesis"],["lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","lr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr","mwlr"],["Both","Both","Both","Both","Both","Both","Events","Events","Events","Time","Time","Time","Both","Both","Both","Both","Both","Both","Events","Events","Events","Time","Time","Time","Both","Both","Both","Both","Both","Both","Events","Events","Events","Time","Time","Time","Both","Both","Both","Both","Both","Both","Events","Events","Events","Time","Time","Time","Both","Both","Both","Both","Both","Both","Events","Events","Events","Time","Time","Time","Both","Both","Both","Both","Both","Both","Events","Events","Events","Time","Time","Time","Both","Both","Both","Both","Both","Both","Events","Events","Events","Time","Time","Time","Both","Both","Both","Both","Both","Both","Events","Events","Events","Time","Time","Time","Both","Both","Both","Both","Both","Both","Events","Events","Events","Time","Time","Time","Both","Both","Both","Both","Both","Both","Events","Events","Events","Time","Time","Time"],["Events","Events","Events","min(planned, actual)","min(planned, actual)","min(planned, actual)","Events","Events","Events","Time","Time","Time","IF","IF","IF","min(planned, actual)","min(planned, actual)","min(planned, actual)","IF","IF","IF","Time","Time","Time","Events","Events","Events","min(planned, actual)","min(planned, actual)","min(planned, actual)","Events","Events","Events","Time","Time","Time","IF","IF","IF","min(planned, actual)","min(planned, actual)","min(planned, actual)","IF","IF","IF","Time","Time","Time","Events","Events","Events","min(planned, actual)","min(planned, actual)","min(planned, actual)","Events","Events","Events","Time","Time","Time","IF","IF","IF","min(planned, actual)","min(planned, actual)","min(planned, actual)","IF","IF","IF","Time","Time","Time","Events","Events","Events","min(planned, actual)","min(planned, actual)","min(planned, actual)","Events","Events","Events","Time","Time","Time","IF","IF","IF","min(planned, actual)","min(planned, actual)","min(planned, actual)","IF","IF","IF","Time","Time","Time","Events","Events","Events","min(planned, actual)","min(planned, actual)","min(planned, actual)","Events","Events","Events","Time","Time","Time","IF","IF","IF","min(planned, actual)","min(planned, actual)","min(planned, actual)","IF","IF","IF","Time","Time","Time"],["1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3","1","2","3"],[0.006218355416409103,0.01011947976078053,0.0086621648228105,0.005696149378715099,0.009863215268450132,0.009440635352834903,0.005696149378715106,0.009863215268486762,0.009440635352834906,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.001607034128476172,0.009940234908249792,0.01345273096327417,0.001338286058232777,0.009577914678358057,0.0140837992634093,0.001296606122839357,0.009256813976842438,0.01444657990031834,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.01064661090105997,0.01099840423523527,0.003354984863704889,0.005696149378715099,0.009863215268450132,0.009440635352834903,0.005696149378715106,0.009863215268486762,0.009440635352834906,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.005141304825313938,0.0135162359143867,0.006342459260299495,0.00140942085156812,0.009981156018112801,0.01360942313031921,0.001364507816074184,0.009159250148479178,0.01447624203544677,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.005696253900623272,0.009863114556653462,0.009440631542723399,0.005696149378715099,0.009190450181234868,0.01011340044005017,0.005696149378715106,0.009863215268486762,0.009440635352834906,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.001219939249721565,0.00936937918300251,0.01441068156727606,0.001219906849477207,0.009369411583246869,0.01441068156727606,0.001219882922260554,0.009369430790054261,0.01441068628768532,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.006112342201754099,0.01051461450286239,0.008373043295383647,0.005696149378715099,0.009863215268450132,0.009440635352834903,0.005696149378715106,0.009863215268486762,0.009440635352834906,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.001568942539255701,0.01036196780288573,0.0130690896578587,0.001346310960313536,0.009665224370110356,0.01398846466957624,0.001323266852455717,0.009240774564504214,0.0144359585830402,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.008815711143132704,0.0128457968173217,0.003338492039545728,0.005696149378715099,0.009863215268450132,0.009440635352834903,0.005696149378715106,0.009863215268486762,0.009440635352834906,0.002597553630153238,0.008213305234746393,0.0141891411351005,0.003576584184548299,0.01513945403551502,0.006283961779936818,0.00140783520851443,0.009982275506631132,0.01360988928485457,0.001403753293961257,0.009143644469514467,0.01445260223652441,0.002597553630153238,0.008213305234746393,0.0141891411351005],[213.2115,276.98143,321.59833,213.2115,276.98143,321.59833,209,273,318,208.82557,272.91157,317.95474,213.2115,276.98143,321.59833,213.2115,276.98143,321.59833,209,273,318,208.82557,272.91157,317.95474,244.49542,302.98203,341.7586,244.49542,302.98203,341.7586,209,273,318,244.49425,302.97932,341.75251,244.49542,302.98203,341.7586,244.49542,302.98203,341.7586,209,273,318,244.49425,302.97932,341.75251,209.00088,273.00002,318,209.00088,273.00002,318,209,273,318,172.31049,229.42694,273.60518,209.00088,273.00002,318,209.00088,273.00002,318,209,273,318,172.31049,229.42694,273.60518,212.36802,278.44501,324.60756,212.36802,278.44501,324.60756,209,273,318,206.98702,275.5649,322.93058,212.36802,278.44501,324.60756,212.36802,278.44501,324.60756,209,273,318,206.98702,275.5649,322.93058,232.40914,303.08114,348.62266,232.40914,303.08114,348.62266,209,273,318,232.34037,303.07745,348.62214,232.40914,303.08114,348.62266,232.40914,303.08114,348.62266,209,273,318,232.34037,303.07745,348.62214],[20.38455058252935,28.44193194033211,36.78542862976705,20.38455058252935,28.44193194033211,36.78542862976705,19.94073437625065,27.82169677164468,35.9525898699199,19.948101820869,27.8535544775178,36.01609370932571,20.38455058252935,28.44193194033211,36.78542862976705,20.38455058252935,28.44193194033211,36.78542862976705,19.94073437625065,27.82169677164468,35.9525898699199,19.948101820869,27.8535544775178,36.01609370932571,19.94819998245095,27.85386959021113,36.01733186170572,19.94819998245095,27.85386959021113,36.01733186170572,16.50812742184127,23.32794836033883,30.53766218201059,19.948101820869,27.8535544775178,36.01609370932571,19.94819998245095,27.85386959021113,36.01733186170572,19.94819998245095,27.85386959021113,36.01733186170572,16.50812742184127,23.32794836033883,30.53766218201059,19.948101820869,27.8535544775178,36.01609370932571,24.72489212514279,35.82635338798729,47.47313497765267,24.72489212514279,35.82635338798729,47.47313497765267,24.72479590484528,35.82634722952832,47.47313497765267,19.948101820869,27.8535544775178,36.01609370932571,24.72489212514279,35.82635338798729,47.47313497765267,24.72489212514279,35.82635338798729,47.47313497765267,24.72479590484528,35.82634722952832,47.47313497765267,19.948101820869,27.8535544775178,36.01609370932571,20.44758736894509,28.24055769682192,36.34319305785163,20.44758736894509,28.24055769682192,36.34319305785163,20.11528413725028,27.45007295128077,34.92596846498109,19.948101820869,27.8535544775178,36.01609370932571,20.44758736894509,28.24055769682192,36.34319305785163,20.44758736894509,28.24055769682192,36.34319305785163,20.11528413725028,27.45007295128077,34.92596846498109,19.948101820869,27.8535544775178,36.01609370932571,19.95363070504828,27.85398538582397,36.01618222096864,19.95363070504828,27.85398538582397,36.01618222096864,17.95959929630853,23.99914832636356,30.06581763982737,19.948101820869,27.8535544775178,36.01609370932571,19.95363070504828,27.85398538582397,36.01618222096864,19.95363070504828,27.85398538582397,36.01618222096864,17.95959929630853,23.99914832636356,30.06581763982737,19.948101820869,27.8535544775178,36.01609370932571],[0.367,0.7534099999999999,0.89398,0.35673,0.74804,0.89638,0.33752,0.73266,0.8882599999999999,0.2461,0.69399,0.90011,0.29469,0.80585,0.94272,0.27891,0.80109,0.9433699999999999,0.25843,0.7836000000000001,0.93855,0.32981,0.78169,0.93971,0.08801,0.46813,0.65567,0.05838,0.42757,0.72023,0.01405,0.24538,0.5765400000000001,0.0333,0.38144,0.73502,0.15324,0.7304999999999999,0.8892899999999999,0.07581,0.6715500000000001,0.9144800000000001,0.01452,0.44031,0.82861,0.10764,0.65681,0.91468,0.39128,0.82037,0.9441700000000001,0.39128,0.8149500000000001,0.94459,0.39127,0.82037,0.94417,0.12615,0.5924700000000001,0.87273,0.31817,0.87639,0.9776900000000001,0.31817,0.87639,0.9776900000000001,0.31816,0.87639,0.9776899999999999,0.18386,0.70724,0.9313499999999999,0.53281,0.7949200000000001,0.88559,0.52364,0.7873600000000001,0.88766,0.51558,0.7774700000000001,0.87971,0.4045,0.74236,0.8914,0.33448,0.7398400000000001,0.87758,0.32091,0.73024,0.87853,0.31131,0.71391,0.8708899999999999,0.38631,0.72082,0.87647,0.009050000000000001,0.02235,0.02521,0.00583,0.0157,0.02523,0.00593,0.01567,0.02518,0.00265,0.011,0.02504,0.004,0.01917,0.02532,0.00147,0.01167,0.02528,0.00163,0.01084,0.0251,0.00299,0.01116,0.02537],[0.6704764150943396,0.871010786163522,1.011315503144654,0.6704764150943396,0.871010786163522,1.011315503144654,0.6572327044025157,0.8584905660377359,1,0.6566542452830189,0.8581599056603774,0.9997607547169811,0.5023057211556242,0.7867931691049742,0.9937665265237553,0.5023057211556242,0.7867931691049742,0.9937665265237553,0.4854714790717098,0.768292321026822,0.9770317587407112,0.485134815692828,0.7679391854335906,0.9769053904834498,0.7688535220125786,0.952773679245283,1.074712578616352,0.7688535220125786,0.952773679245283,1.074712578616352,0.6572327044025157,0.8584905660377359,1,0.7688070754716981,0.9526833018867925,1.074528333333333,0.6373777990933035,0.9068487952659737,1.086679178740891,0.6373777990933035,0.9068487952659737,1.086679178740891,0.4898835817184914,0.7677049552813719,0.9764329215545474,0.637373026058299,0.9068362651780338,1.086651009246893,0.6572354716981131,0.8584906289308176,1,0.6572354716981131,0.8584906289308176,1,0.6572327044025157,0.8584905660377359,1,0.5418417295597484,0.7214461320754717,0.8603554716981132,0.4802720509379321,0.7690022091376705,0.9777530099297355,0.4802720509379321,0.7690022091376705,0.9777530099297355,0.480268554965801,0.7690021163471975,0.9777530099297355,0.3453468939355898,0.5685285201198097,0.7718649014395276,0.6678239622641509,0.8756132389937107,1.020778490566038,0.6678239622641509,0.8756132389937107,1.020778490566038,0.6572327044025157,0.8584905660377359,1,0.6508711320754716,0.8664978616352201,1.015399119496855,0.5005205820351109,0.7937977706867146,1.007954417120304,0.5005205820351109,0.7937977706867146,1.007954417120304,0.4872328505406364,0.768502316522542,0.9772415937164783,0.4796874267284291,0.7804588437612283,1.000198571131853,0.7308463522012578,0.9530853459119497,1.096297672955975,0.7308463522012578,0.9530853459119497,1.096297672955975,0.6572327044025157,0.8584905660377359,1,0.7305858805031447,0.952992106918239,1.09616144654088,0.5868570173939089,0.9077551315654728,1.119024897829618,0.5868570173939089,0.9077551315654728,1.119024897829618,0.4924076179496022,0.7681730622751396,0.9769037676023477,0.5865860070882275,0.90773805471296,1.119022484627496],[0.6704764150943396,0.871010786163522,1.011315503144654,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.5538663349185977,0.773364116117502,1,0.5023057211556242,0.7867931691049742,1.007594295338483,0.4881931739198697,0.7753551337209488,1,0.4854714790717098,0.768292321026822,1,0.5538663349185977,0.773364116117502,1,0.7688535220125786,0.952773679245283,1.074712578616352,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.5538663349185977,0.773364116117502,1,0.6373777990933035,0.9068487952659737,1.086829808548092,0.4928552048224717,0.7845721226185347,1,0.4898835817184914,0.7677049552813719,1,0.5538663349185977,0.773364116117502,1,0.6572354716981131,0.8584906289308176,1,0.6572327044025157,0.8469445283018868,1,0.6572327044025157,0.8584905660377359,1,0.5538663349185977,0.773364116117502,1,0.4802720509379321,0.7690022091376705,1,0.4802701281675308,0.7690022091376705,1,0.480268554965801,0.7690021163471975,1,0.5538663349185977,0.773364116117502,1,0.6678239622641509,0.8756132389937107,1.020778490566038,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.5538663349185977,0.773364116117502,1,0.5005205820351109,0.7937977706867146,1.01670690197728,0.4887376743691097,0.7772105897570127,1,0.4872328505406364,0.768502316522542,1,0.5538663349185977,0.773364116117502,1,0.7308463522012578,0.9530853459119497,1.096297672955975,0.6572327044025157,0.8584905660377359,1,0.6572327044025157,0.8584905660377359,1,0.5538663349185977,0.773364116117502,1,0.5868570173939089,0.9077551315654728,1.119037240785298,0.492752298015478,0.7845631066795467,1,0.4924076179496022,0.7681730622751396,1,0.5538663349185977,0.773364116117502,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>test<\/th>\n      <th>Scenario<\/th>\n      <th>Test<\/th>\n      <th>Cut<\/th>\n      <th>Spending<\/th>\n      <th>Analysis<\/th>\n      <th>E(Spend)<\/th>\n      <th>E(Events)<\/th>\n      <th>E(Time)<\/th>\n      <th>Power<\/th>\n      <th>E(IF)<\/th>\n      <th>E(sTime)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"filter":"top","pageLength":25,"dom":"Bfrtip","buttons":["copy","csv","excel"],"scrollX":true,"columnDefs":[{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \",\", \".\", null);\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 3, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \",\", \".\", null);\n  }"},{"className":"dt-right","targets":[7,8,9,10,11,12]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"test","targets":1},{"name":"Scenario","targets":2},{"name":"Test","targets":3},{"name":"Cut","targets":4},{"name":"Spending","targets":5},{"name":"Analysis","targets":6},{"name":"E(Spend)","targets":7},{"name":"E(Events)","targets":8},{"name":"E(Time)","targets":9},{"name":"Power","targets":10},{"name":"E(IF)","targets":11},{"name":"E(sTime)","targets":12}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render"],"jsHooks":{"render":[{"code":"\nfunction(el, x) {\n$(el).find('table').css('font-size', '0.6em');\n$(el).find('td').css('padding', '1px 1px');\n$(el).find('th').css('padding', '1px 1px');\n$(el).find('table').css('width', 'auto');\n$(el).find('.dataTables_wrapper').css('width', 'auto');\n}\n","data":null}]}}</script>
<pre class="r"><code>power_summary &lt;- result_summary |&gt;
  group_by(Scenario, test, Cut, Spending) |&gt;
  summarize(
    Power = last(Power),
    Events = last(`E(Events)`),
    &quot;Final spend&quot; = last(`E(Spend)`)
  ) |&gt;
  mutate(CutSp = interaction(Cut, Spending))

# Create plots to visualize results
p1 &lt;- power_summary |&gt;
  ggplot(aes(x = Scenario, y = Power, fill = CutSp)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  facet_wrap(~test) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylab(&quot;Power&quot;) +
  xlab(&quot;Scenario&quot;) +
  # Make legend label &quot;Cut.Spending&quot;
  labs(fill = &quot;Cut.Spending&quot;)

p2 &lt;- power_summary |&gt;
  ggplot(aes(x = Scenario, y = `Events`, fill = Cut)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  facet_wrap(~test) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylab(&quot;Mean Events&quot;) +
  xlab(&quot;Scenario&quot;)

p3 &lt;- power_summary |&gt;
  ggplot(aes(x = Scenario, y = `Final spend`, fill = CutSp)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  facet_wrap(~test) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylab(&quot;Final nominal p&quot;) +
  xlab(&quot;Scenario&quot;)

# Display plots with increased height
cowplot::plot_grid(p1, p2, p3, ncol = 1, labels = c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;), rel_heights = c(1, 1, 1))</code></pre>
<p><img src="https://keaven.github.io/blog/delayed-effect-simulation/index_files/figure-html/unnamed-chunk-31-1.png" width="100%" /></p>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>We have suggested the concept of spending time and provided 3 examples where
the approach can be applied to simply adapt a design in a useful way.
That is, if design assumptions are not met:</p>
<ul>
<li>execution is automatically adapted without protocol amendment,</li>
<li>if there is a delayed treatment effect a trial can continue long enough and
adequate <span class="math inline">\(\alpha\)</span>-spending can be preserved to the final analysis where
the full treatment effect can be realized and evaluated,</li>
<li>if testing in multiple populations, spending can be automatically adapted
so that <span class="math inline">\(\alpha\)</span> is preserved until the final analysis and tests in
all populations of interest can be maintained.</li>
</ul>
<p>There are many potential solutions to issues that may arise related to
error spending in group sequential trials.
<span class="citation">Michael A. Proschan, Lan, and Wittes (<a href="#ref-PLWBook">2006</a>)</span> discuss approaches such as using calendar time or adjusting
future spending time on an adaptive basis at the time of analysis.
We propose the concept of spending time as a more flexible alternative than
information fraction for allocation of error spending between interim and
final analyses in a group sequential trial.
In particular, we have used spending time to ensure adequate Type I error
spending is preserved for the final analysis in a trial, and
timing of final analysis is not premature.</p>
<ul>
<li>For the case of a single endpoint where there may be a delayed treatment
effect, we have proposed spending using the minimum of planned and observed
information fraction at the time of an analysis. This is combined with
potentially delaying the final analysis to achieve at least a minimum trial
duration or follow-up duration for all study participants as well as
achieving targeted events (statistical information).</li>
<li>When testing multiple hypotheses on a single endpoint, we propose the
minimum spending fraction based on all hypotheses being evaluated;
this is in line with the suggestion of <span class="citation">Follman, Proschan, and Geller (<a href="#ref-FPG">1994</a>)</span> for testing multiple
experimental arms versus a common control in a group sequential trial.
As an example, consider an oncology trial where both
progression free survival (PFS) and overall survival (OS) are tested.
Timing of interim analyses may be primarily determined by time and PFS
event counts, while the final analysis is determined by time and OS event counts.
Spending time can be used to determine interim and final <span class="math inline">\(\alpha\)</span>-spending
separately for PFS and OS in a way that adapts simply for all hypotheses tested.
This includes the ability to use multiple testing procedures such as the
graphical method of <span class="citation">Maurer and Bretz (<a href="#ref-MaurerBretz2013">2013</a>)</span>.</li>
</ul>
<p>For the biomarker postive and overall population testing, adapting the overall
sample size and spending based on enrolling the targeted biomarker positive
sample size and spending according to events achieved in the biomarker subgroup
for both population was effective at achieving targeted power and completing
the trial in a timely fashion. The Fleming-Harrington-O’Brien spending approach
mimicing Haybittle-Peto bounds was also effective at maintaining power and
controlling Type I error.
Depending on whether or not you wish to be conservative for early stopping
(Haybittle-Peto) or more liberal with early stopping (O’Brien-Fleming-like bound),
either approach can be used.</p>
<p>The scenarios considered are diverse, but not comprehensive.
However, they illustrate several issues that should be considered at the time
of design of a group sequential trial.
Examples have been demonstrated with the design software of the gsDesign2
R package and the simulation R package simtrial.</p>
</div>
<div id="session-info" class="section level2">
<h2>Session info</h2>
<pre class="r"><code>sessioninfo::session_info(pkgs = &quot;attached&quot;)</code></pre>
<pre><code>#&gt; ─ Session info ───────────────────────────────────────────────────────────────
#&gt;  setting  value
#&gt;  version  R version 4.5.1 (2025-06-13 ucrt)
#&gt;  os       Windows 11 x64 (build 26100)
#&gt;  system   x86_64, mingw32
#&gt;  ui       RTerm
#&gt;  language (EN)
#&gt;  collate  English_United States.utf8
#&gt;  ctype    English_United States.utf8
#&gt;  tz       America/New_York
#&gt;  date     2025-07-10
#&gt;  pandoc   3.7.0.2 @ C:/PROGRA~3/CHOCOL~1/bin/ (via rmarkdown)
#&gt;  quarto   NA @ C:\\PROGRA~1\\RStudio\\RESOUR~1\\app\\bin\\quarto\\bin\\quarto.exe
#&gt; 
#&gt; ─ Packages ───────────────────────────────────────────────────────────────────
#&gt;  package    * version date (UTC) lib source
#&gt;  cowplot    * 1.2.0   2025-07-07 [1] CRAN (R 4.5.1)
#&gt;  doFuture   * 1.1.1   2025-06-06 [1] CRAN (R 4.5.0)
#&gt;  dplyr      * 1.1.4   2023-11-17 [1] CRAN (R 4.5.0)
#&gt;  DT         * 0.33    2024-04-04 [1] CRAN (R 4.5.0)
#&gt;  foreach    * 1.5.2   2022-02-02 [1] CRAN (R 4.5.0)
#&gt;  future     * 1.58.0  2025-06-05 [1] CRAN (R 4.5.0)
#&gt;  ggplot2    * 3.5.2   2025-04-09 [1] CRAN (R 4.5.0)
#&gt;  gsDesign   * 3.6.9   2025-06-25 [1] CRAN (R 4.5.1)
#&gt;  gsDesign2  * 1.1.5   2025-06-27 [1] CRAN (R 4.5.1)
#&gt;  gt         * 1.0.0   2025-04-05 [1] CRAN (R 4.5.0)
#&gt;  parallelly * 1.45.0  2025-06-02 [1] CRAN (R 4.5.0)
#&gt;  purrr      * 1.0.4   2025-02-05 [1] CRAN (R 4.5.0)
#&gt;  simtrial   * 1.0.0   2025-06-11 [1] CRAN (R 4.5.1)
#&gt;  tibble     * 3.3.0   2025-06-08 [1] CRAN (R 4.5.0)
#&gt;  tictoc     * 1.2.1   2024-03-18 [1] CRAN (R 4.5.0)
#&gt; 
#&gt;  [1] C:/Users/me/AppData/Local/R/win-library/4.5
#&gt;  [2] C:/Program Files/R/R-4.5.1/library
#&gt;  * ── Packages attached to the search path.
#&gt; 
#&gt; ──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-FHO" class="csl-entry">
Fleming, Thomas R, David P Harrington, and Peter C O’Brien. 1984. <span>“Designs for Group Sequential Tests.”</span> <em>Controlled Clinical Trials</em> 5 (4): 348–61.
</div>
<div id="ref-FPG" class="csl-entry">
Follman, Dean A., Michael A. Proschan, and Nancy L. Geller. 1994. <span>“Monitoring Pairwise Comparisons in Multi-Armed Clinical Trials.”</span> <em>Biometrics</em> 50: 325–36.
</div>
<div id="ref-LanDeMets" class="csl-entry">
Lan, K. K. G., and David L. DeMets. 1983. <span>“Discrete Sequential Boundaries for Clinical Trials.”</span> <em>Biometrika</em> 70: 659–63.
</div>
<div id="ref-LanDeMets1989" class="csl-entry">
———. 1989. <span>“Group Sequential Procedures: Calendar Versus Information Time.”</span> <em>Statistics in Medicine</em> 8: 1191–98.
</div>
<div id="ref-NPHWG2020sim" class="csl-entry">
Lin, Ray S, Ji Lin, Satrajit Roychoudhury, Keaven M. Anderson, Tianle Hu, Bo Huang, Larry F Leon, et al. 2020. <span>“Alternative Analysis Methods for Time to Event Endpoints Under Nonproportional Hazards: A Comparative Analysis.”</span> <em>Statistics in Biopharmaceutical Research</em> 12 (2): 187–98.
</div>
<div id="ref-magirr2019modestly" class="csl-entry">
Magirr, Dominic, and Carl-Fredrik Burman. 2019. <span>“Modestly Weighted Logrank Tests.”</span> <em>Statistics in Medicine</em> 38 (20): 3782–90.
</div>
<div id="ref-MaurerBretz2013" class="csl-entry">
Maurer, Willi, and Frank Bretz. 2013. <span>“Multiple Testing in Group Sequential Trials Using Graphical Approaches.”</span> <em>Statistics in Biopharmaceutical Research</em> 5: 311–20.
</div>
<div id="ref-AHR2020" class="csl-entry">
Mukhopadhyay, Pralay, Wenmei Huang, Paul Metcalfe, Fredrik Öhrn, Mary Jenner, and Andrew Stone. 2020. <span>“Statistical and Practical Considerations in Designing of Immuno-Oncology Trials.”</span> <em>Journal of Biopharmaceutical Statistics</em> 30 (6): 1130–46.
</div>
<div id="ref-PFW" class="csl-entry">
Proschan, Michael A, Dean A Follmann, and Myron A Waclawiw. 1992. <span>“Effects of Assumption Violations on Type <span>I</span> Error Rate in Group Sequential Monitoring.”</span> <em>Biometrics</em>, 1131–43.
</div>
<div id="ref-PLWBook" class="csl-entry">
Proschan, Michael A., K. K. Gordon Lan, and Janet Turk Wittes. 2006. <em>Statistical Monitoring of Clinical Trials. A Unified Approach.</em> New York, NY: Springer.
</div>
<div id="ref-NPHWG2021Design" class="csl-entry">
Roychoudhury, Satrajit, Keaven M. Anderson, Jiabu Ye, and Pralay Mukhopadhyay. 2021. <span>“Robust Design and Analysis of Clinical Trials with Non-Proportional Hazards: A Straw Man Guidance from a Cross-Pharma Working Group.”</span> <em>Statistics in Biopharmaceutical Research</em>, 1–37.
</div>
<div id="ref-Tsiatis1982" class="csl-entry">
Tsiatis, Anastasios A. 1982. <span>“Repeated Significance Testing for a General Class of Statistics Use in Censored Survival Analysis.”</span> <em>Journal of the American Statistical Association</em> 77: 855–61.
</div>
<div id="ref-zhao2024group" class="csl-entry">
Zhao, Yujie, Yilong Zhang, and Keaven M Anderson. 2024. <span>“Group Sequential Design Under Non-Proportional Hazards: Methodologies and Examples.”</span> In <em>Biostatistics in Biopharmaceutical Research and Development: Clinical Trial Design, Volume 1</em>, 219–34. Springer.
</div>
</div>
</div>

    </div>
  </article>

  


</main>

      <footer class="footer">
        <ul class="footer-links">
          
        </ul>
      </footer>

    </div>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); window.addEventListener('load', function() { hljs.highlightAll(); }, true);</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

